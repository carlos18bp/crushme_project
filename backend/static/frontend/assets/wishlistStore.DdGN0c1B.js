import{I as ae,r as h,l as w,M as y,L as _,V as te,J as $,K as re}from"./index.T4J3j10_.js";import{W as C}from"./constants.DjCFsGER.js";const ie=ae("wishlist",()=>{const n=h([]),v=h(null),F=h([]),W=h([]),f=h(!1),p=h(!1),d=h(!1),t=h(null),x=w(()=>n.value.length),g=w(()=>n.value.filter(e=>e.is_active)),P=w(()=>g.value.filter(e=>e.is_public)),S=w(()=>g.value.filter(e=>!e.is_public)),L=w(()=>n.value.length>0),U=w(()=>n.value.reduce((e,a)=>e+parseFloat(a.total_value||0),0)),q=w(()=>n.value.reduce((e,a)=>e+(a.total_items||0),0));async function B(){var e,a;f.value=!0,t.value=null;try{const s=await y("wishlists/");return n.value=s.data.wishlists||[],{success:!0,data:n.value}}catch(s){return t.value=((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.error)||"Failed to fetch wishlists",{success:!1,error:t.value}}finally{f.value=!1}}async function O(e){var a,s;p.value=!0,t.value=null;try{const r=await y(`wishlists/${e}/`);return v.value=r.data.wishlist,{success:!0,data:r.data.wishlist}}catch(r){return t.value=((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to fetch wishlist",v.value=null,{success:!1,error:t.value}}finally{p.value=!1}}async function T(e){var a,s,r,u;d.value=!0,t.value=null;try{const l=await _("wishlists/create/",e),c=l.data.wishlist;return n.value.unshift(c),{success:!0,message:l.data.message,data:c}}catch(l){return t.value=((s=(a=l.response)==null?void 0:a.data)==null?void 0:s.details)||((u=(r=l.response)==null?void 0:r.data)==null?void 0:u.error)||"Failed to create wishlist",{success:!1,error:t.value}}finally{d.value=!1}}async function j(e,a){var s,r,u,l,c;d.value=!0,t.value=null;try{const i=await te(`wishlists/${e}/update/`,a),o=i.data.wishlist,m=n.value.findIndex(b=>b.id===e);return m!==-1&&(n.value[m]=o),((s=v.value)==null?void 0:s.id)===e&&(v.value=o),{success:!0,message:i.data.message,data:o}}catch(i){return t.value=((u=(r=i.response)==null?void 0:r.data)==null?void 0:u.details)||((c=(l=i.response)==null?void 0:l.data)==null?void 0:c.error)||"Failed to update wishlist",{success:!1,error:t.value}}finally{d.value=!1}}async function A(e){var a,s,r;d.value=!0,t.value=null;try{const u=await $(`wishlists/${e}/delete/`);return n.value=n.value.filter(l=>l.id!==e),((a=v.value)==null?void 0:a.id)===e&&(v.value=null),{success:!0,message:u.data.message}}catch(u){return t.value=((r=(s=u.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to delete wishlist",{success:!1,error:t.value}}finally{d.value=!1}}async function E(e,a,s="",r="medium"){var u,l;d.value=!0,t.value=null;try{const c=await _(`wishlists/${e}/add-woocommerce-product/`,{woocommerce_product_id:a,notes:s,priority:r}),i=c.data.wishlist,o=n.value.findIndex(m=>m.id===e);return o!==-1&&(n.value[o]=i),((u=v.value)==null?void 0:u.id)===e&&(v.value=i),{success:!0,message:c.data.message,data:i}}catch(c){let i="Failed to add product to wishlist";if((l=c.response)!=null&&l.data){const o=c.response.data;o.woocommerce_product_id&&Array.isArray(o.woocommerce_product_id)?i=o.woocommerce_product_id[0]:o.error?i=o.error:o.details&&(i=o.details)}return t.value=i,{success:!1,error:i}}finally{d.value=!1}}async function I(e,a){var s,r,u;d.value=!0,t.value=null;try{const l=await $(`wishlists/${e}/remove-woocommerce-product/${a}/`),c=l.data.wishlist,i=n.value.findIndex(o=>o.id===e);return i!==-1&&(n.value[i]=c),((s=v.value)==null?void 0:s.id)===e&&(v.value=c),{success:!0,message:l.data.message,data:c}}catch(l){return t.value=((u=(r=l.response)==null?void 0:r.data)==null?void 0:u.error)||"Failed to remove product from wishlist",{success:!1,error:t.value}}finally{d.value=!1}}async function M(e){var a,s,r;d.value=!0,t.value=null;try{const u=await _(`wishlists/${e}/refresh-products/`,{}),l=u.data.wishlist,c=n.value.findIndex(i=>i.id===e);return c!==-1&&(n.value[c]=l),((a=v.value)==null?void 0:a.id)===e&&(v.value=l),{success:!0,message:u.data.message,updated_count:u.data.updated_count,failed_count:u.data.failed_count,data:l}}catch(u){return t.value=((r=(s=u.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to refresh products",{success:!1,error:t.value}}finally{d.value=!1}}async function R(e){var a,s;p.value=!0,t.value=null;try{return{success:!0,data:(await y(`wishlists/public/${e}/`)).data.wishlist}}catch(r){return t.value=((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to fetch public wishlist",{success:!1,error:t.value}}finally{p.value=!1}}async function V(e,a){var s,r;p.value=!0,t.value=null;try{return{success:!0,data:(await y(`wishlists/@${e}/${a}/`)).data.wishlist}}catch(u){return t.value=((r=(s=u.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to fetch public wishlist",{success:!1,error:t.value}}finally{p.value=!1}}async function D(e){var a,s,r,u;f.value=!0,t.value=null;try{const l=await y(`wishlists/user/${e}/`);return l.data.success?{success:!0,data:l.data.wishlists||[],user:{username:l.data.username,fullName:l.data.user_full_name,totalWishlists:l.data.total_wishlists},message:l.data.message}:{success:!1,error:l.data.message||"User has no public wishlists"}}catch(l){return t.value=((s=(a=l.response)==null?void 0:a.data)==null?void 0:s.message)||((u=(r=l.response)==null?void 0:r.data)==null?void 0:u.error)||"Failed to fetch user wishlists",{success:!1,error:t.value}}finally{f.value=!1}}async function H(){var e,a;f.value=!0,t.value=null;try{const s=await y("wishlists/public/");return F.value=s.data.wishlists||[],{success:!0,data:F.value}}catch(s){return t.value=((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.error)||"Failed to search public wishlists",{success:!1,error:t.value}}finally{f.value=!1}}async function J(e){var a,s;d.value=!0,t.value=null;try{return{success:!0,message:(await _(`wishlists/${e}/favorite/`,{})).data.message}}catch(r){return t.value=((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to favorite wishlist",{success:!1,error:t.value}}finally{d.value=!1}}async function K(e){var a,s;d.value=!0,t.value=null;try{const r=await $(`wishlists/${e}/unfavorite/`);return W.value=W.value.filter(u=>u.wishlist.id!==e),{success:!0,message:r.data.message}}catch(r){return t.value=((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to unfavorite wishlist",{success:!1,error:t.value}}finally{d.value=!1}}async function N(){var e,a;f.value=!0,t.value=null;try{const s=await y("wishlists/favorites/");return W.value=s.data.favorite_wishlists||[],{success:!0,data:W.value}}catch(s){return t.value=((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.error)||"Failed to fetch favorite wishlists",{success:!1,error:t.value}}finally{f.value=!1}}async function k(e,a){var s,r,u,l,c;d.value=!0,t.value=null;try{const i=await re(`wishlists/${e}/shipping/`,a),o=i.data.wishlist,m=n.value.findIndex(b=>b.id===e);return m!==-1&&(n.value[m]=o),((s=v.value)==null?void 0:s.id)===e&&(v.value=o),{success:!0,message:i.data.message,data:o}}catch(i){return t.value=((u=(r=i.response)==null?void 0:r.data)==null?void 0:u.details)||((c=(l=i.response)==null?void 0:l.data)==null?void 0:c.error)||"Failed to update shipping info",{success:!1,error:t.value}}finally{d.value=!1}}function z(e){return n.value.find(a=>a.id===e)||null}function G(e){return n.value.some(a=>{var s;return(s=a.items)==null?void 0:s.some(r=>r.woocommerce_product_id===e)})}function Q(e){return n.value.filter(a=>{var s;return(s=a.items)==null?void 0:s.some(r=>r.woocommerce_product_id===e)})}function X(e){const a=C.find(s=>s.value===e);return a?a.label:e}function Y(e){const a=C.find(s=>s.value===e);return a?a.color:"text-gray-500"}function Z(){v.value=null}function ee(){t.value=null}function se(){return{total:x.value,active:g.value.length,public:P.value.length,private:S.value.length,total_value:U.value,total_items:q.value,favorites:W.value.length}}return{wishlists:n,currentWishlist:v,publicWishlists:F,favoriteWishlists:W,isLoading:f,isLoadingWishlist:p,isUpdating:d,error:t,totalWishlists:x,activeWishlists:g,publicUserWishlists:P,privateWishlists:S,hasWishlists:L,totalWishlistValue:U,totalWishlistItems:q,fetchWishlists:B,fetchWishlist:O,createWishlist:T,updateWishlist:j,deleteWishlist:A,addWooCommerceProductToWishlist:E,removeWooCommerceProductFromWishlist:I,refreshWishlistProducts:M,fetchPublicWishlistByUUID:R,fetchPublicWishlistByUsername:V,fetchWishlistsByUsername:D,searchPublicWishlists:H,favoriteWishlist:J,unfavoriteWishlist:K,fetchFavoriteWishlists:N,updateWishlistShipping:k,getWishlistById:z,isWooCommerceProductInWishlist:G,getWishlistsWithProduct:Q,getPriorityLabel:X,getPriorityColor:Y,clearCurrentWishlist:Z,clearError:ee,getWishlistStatistics:se}});export{ie as u};
