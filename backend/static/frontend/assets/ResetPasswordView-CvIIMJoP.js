import{s as j,u as V,r as w,C as z,x as L,l as N,c as i,b as d,d as s,f as k,t as r,y as F,j as T,p as P,A as _,n as D,k as E,e as y,w as I,g as U,h as H,m as W}from"../index.js";import{u as Z}from"./authStore-DVIAn0uN.js";import{u as G}from"./useAlert-BgI_2DEv.js";import{L as J}from"./LanguageSelector-Cde5xz4W.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-DjCFsGER.js";const O={class:"reset-password-view"},Q={class:"reset-password-container"},X={class:"reset-password-card"},Y={class:"welcome-section"},ss={class:"welcome-title"},es={class:"welcome-subtitle"},ts={class:"input-group"},os={class:"password-input-container"},rs=["type","placeholder"],ns={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},as={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ls={class:"password-requirements"},is={class:"requirements-title"},ds={class:"requirements-list"},us={class:"input-group"},ws={class:"password-input-container"},cs=["type","placeholder"],ps={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},hs={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ms={key:0,class:"password-strength"},gs={class:"strength-label"},vs={class:"strength-bar"},fs=["disabled"],ks={key:0},Ps={key:1,class:"loading-spinner"},_s={class:"back-link"},ys={__name:"ResetPasswordView",setup(bs){const b=W(),v=z(),{t:n}=j(),g=V(),C=Z(),{showError:u}=G(),f=w(v.query.email||""),$=w(v.query.reset_code||""),o=L({newPassword:"",confirmPassword:""}),c=w(!1),p=w(!1),h=w(!1),M=()=>{p.value=!p.value},q=()=>{h.value=!h.value},m=N(()=>{const e=o.newPassword;let t=0;return e.length>=8&&t++,e.match(/[a-z]/)&&t++,e.match(/[A-Z]/)&&t++,e.match(/[0-9]/)&&t++,e.match(/[^a-zA-Z0-9]/)&&t++,t}),S=()=>{const e=m.value;return e<2?"Weak":e<4?"Medium":"Strong"},x=()=>{const e=m.value;return e<2?"strength-weak":e<4?"strength-medium":"strength-strong"},A=()=>`${m.value/5*100}%`,B=()=>!o.newPassword||!o.confirmPassword?(u(n("resetPassword.validation.fillAllFields")),!1):o.newPassword.length<8?(u(n("resetPassword.validation.passwordLength")),!1):o.newPassword!==o.confirmPassword?(u(n("resetPassword.validation.passwordsMatch")),!1):m.value<3?(u(n("resetPassword.validation.passwordStrength")),!1):!0,R=async()=>{var e,t;if(B()){c.value=!0;try{const a=await C.resetPassword({email:f.value,reset_code:$.value,new_password:o.newPassword,new_password_confirm:o.confirmPassword});if(a.success)b.push({path:`/${g.locale}/confirmation`,query:{title:n("resetPassword.success.title"),message:n("resetPassword.success.message"),primaryActionText:n("resetPassword.success.actionButton"),primaryActionRoute:`/${g.locale}/login`}});else{let l=n("resetPassword.errors.updateFailed");(e=a.error)!=null&&e.reset_code?l=n("resetPassword.errors.invalidToken"):(t=a.error)!=null&&t.new_password?l=n("resetPassword.errors.weakPassword"):typeof a.error=="string"?l+=a.error:l+="Error desconocido",u(l)}}catch(a){console.error("Password reset failed:",a),u(n("resetPassword.errors.updateFailed")+(a.message||"Unknown error"))}finally{c.value=!1}}};return(e,t)=>{const a=H("router-link");return d(),i("div",O,[t[8]||(t[8]=s("div",{class:"background-container"},[s("div",{class:"background-overlay"})],-1)),k(J,{position:"absolute",theme:"light"}),s("div",Q,[s("div",X,[s("div",Y,[s("h2",ss,r(e.$t("resetPassword.title")),1),s("p",es,r(e.$t("resetPassword.subtitle")),1)]),s("form",{onSubmit:F(R,["prevent"]),class:"reset-password-form"},[s("div",ts,[s("div",os,[P(s("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>o.newPassword=l),type:p.value?"text":"password",placeholder:e.$t("resetPassword.newPasswordPlaceholder"),class:"form-input password-input",required:"",minlength:"8",autocomplete:"new-password"},null,8,rs),[[_,o.newPassword]]),s("button",{type:"button",onClick:M,class:"password-toggle"},[p.value?(d(),i("svg",ns,[...t[2]||(t[2]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("path",{d:"M1 1l22 22",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(d(),i("svg",as,[...t[3]||(t[3]=[s("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))])])]),s("div",ls,[s("p",is,r(e.$t("resetPassword.passwordRequirements.title")),1),s("ul",ds,[s("li",null,r(e.$t("resetPassword.passwordRequirements.minLength")),1),s("li",null,r(e.$t("resetPassword.passwordRequirements.uppercase")),1),s("li",null,r(e.$t("resetPassword.passwordRequirements.lowercase")),1),s("li",null,r(e.$t("resetPassword.passwordRequirements.number")),1),s("li",null,r(e.$t("resetPassword.passwordRequirements.special")),1)])]),s("div",us,[s("div",ws,[P(s("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>o.confirmPassword=l),type:h.value?"text":"password",placeholder:e.$t("resetPassword.confirmPasswordPlaceholder"),class:"form-input password-input",required:"",autocomplete:"new-password"},null,8,cs),[[_,o.confirmPassword]]),s("button",{type:"button",onClick:q,class:"password-toggle"},[h.value?(d(),i("svg",ps,[...t[4]||(t[4]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("path",{d:"M1 1l22 22",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(d(),i("svg",hs,[...t[5]||(t[5]=[s("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))])])]),o.newPassword?(d(),i("div",ms,[s("div",gs,r(S()),1),s("div",vs,[s("div",{class:E(["strength-fill",x()]),style:D({width:A()})},null,6)])])):T("",!0),s("button",{type:"submit",class:"submit-btn",disabled:c.value},[c.value?(d(),i("span",Ps,[t[6]||(t[6]=s("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" "+r(e.$t("resetPassword.updatingButton")),1)])):(d(),i("span",ks,r(e.$t("resetPassword.updateButton")),1))],8,fs)],32),s("div",_s,[k(a,{to:`/${U(g).locale}/reset-code?email=${f.value.value}`,class:"back-link-text"},{default:I(()=>[t[7]||(t[7]=s("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),y(" "+r(e.$t("resetPassword.backToCode")),1)]),_:1},8,["to"])])])])])}}},As=K(ys,[["__scopeId","data-v-de9bc032"]]);export{As as default};
