import{G as re,r as p,i as y,K as W,J as F,S as le,H as $,I as ue}from"../index.js";import{W as B}from"./constants-DjCFsGER.js";const ce=re("wishlist",()=>{const i=p([]),d=p(null),b=p([]),g=p([]),h=p(!1),m=p(!1),n=p(!1),t=p(null),x=y(()=>i.value.length),_=y(()=>i.value.filter(e=>e.is_active)),P=y(()=>_.value.filter(e=>e.is_public)),S=y(()=>_.value.filter(e=>!e.is_public)),L=y(()=>i.value.length>0),U=y(()=>i.value.reduce((e,a)=>e+parseFloat(a.total_value||0),0)),q=y(()=>i.value.reduce((e,a)=>e+(a.total_items||0),0));async function O(){var e,a;h.value=!0,t.value=null;try{const s=await W("wishlists/");return i.value=s.data.wishlists||[],{success:!0,data:i.value}}catch(s){return t.value=((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.error)||"Failed to fetch wishlists",{success:!1,error:t.value}}finally{h.value=!1}}async function T(e){var a,s;m.value=!0,t.value=null;try{const r=await W(`wishlists/${e}/`);return d.value=r.data.wishlist,{success:!0,data:r.data.wishlist}}catch(r){return t.value=((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to fetch wishlist",d.value=null,{success:!1,error:t.value}}finally{m.value=!1}}async function j(e){var a,s,r,u;n.value=!0,t.value=null;try{const l=await F("wishlists/create/",e),o=l.data.wishlist;return i.value.unshift(o),{success:!0,message:l.data.message,data:o}}catch(l){return t.value=((s=(a=l.response)==null?void 0:a.data)==null?void 0:s.details)||((u=(r=l.response)==null?void 0:r.data)==null?void 0:u.error)||"Failed to create wishlist",{success:!1,error:t.value}}finally{n.value=!1}}async function E(e,a){var s,r,u,l,o;n.value=!0,t.value=null;try{const c=await le(`wishlists/${e}/update/`,a),v=c.data.wishlist,f=i.value.findIndex(w=>w.id===e);return f!==-1&&(i.value[f]=v),((s=d.value)==null?void 0:s.id)===e&&(d.value=v),{success:!0,message:c.data.message,data:v}}catch(c){return t.value=((u=(r=c.response)==null?void 0:r.data)==null?void 0:u.details)||((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.error)||"Failed to update wishlist",{success:!1,error:t.value}}finally{n.value=!1}}async function H(e){var a,s,r;n.value=!0,t.value=null;try{const u=await $(`wishlists/${e}/delete/`);return i.value=i.value.filter(l=>l.id!==e),((a=d.value)==null?void 0:a.id)===e&&(d.value=null),{success:!0,message:u.data.message}}catch(u){return t.value=((r=(s=u.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to delete wishlist",{success:!1,error:t.value}}finally{n.value=!1}}async function I(e,a,s="",r="medium"){var u,l,o,c,v;n.value=!0,t.value=null;try{const f=await F(`wishlists/${e}/add-woocommerce-product/`,{woocommerce_product_id:a,notes:s,priority:r}),w=f.data.wishlist,C=i.value.findIndex(te=>te.id===e);return C!==-1&&(i.value[C]=w),((u=d.value)==null?void 0:u.id)===e&&(d.value=w),{success:!0,message:f.data.message,data:w}}catch(f){return t.value=((o=(l=f.response)==null?void 0:l.data)==null?void 0:o.details)||((v=(c=f.response)==null?void 0:c.data)==null?void 0:v.error)||"Failed to add product to wishlist",{success:!1,error:t.value}}finally{n.value=!1}}async function R(e,a){var s,r,u;n.value=!0,t.value=null;try{const l=await $(`wishlists/${e}/remove-woocommerce-product/${a}/`),o=l.data.wishlist,c=i.value.findIndex(v=>v.id===e);return c!==-1&&(i.value[c]=o),((s=d.value)==null?void 0:s.id)===e&&(d.value=o),{success:!0,message:l.data.message,data:o}}catch(l){return t.value=((u=(r=l.response)==null?void 0:r.data)==null?void 0:u.error)||"Failed to remove product from wishlist",{success:!1,error:t.value}}finally{n.value=!1}}async function D(e){var a,s,r;n.value=!0,t.value=null;try{const u=await F(`wishlists/${e}/refresh-products/`,{}),l=u.data.wishlist,o=i.value.findIndex(c=>c.id===e);return o!==-1&&(i.value[o]=l),((a=d.value)==null?void 0:a.id)===e&&(d.value=l),{success:!0,message:u.data.message,updated_count:u.data.updated_count,failed_count:u.data.failed_count,data:l}}catch(u){return t.value=((r=(s=u.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to refresh products",{success:!1,error:t.value}}finally{n.value=!1}}async function G(e){var a,s;m.value=!0,t.value=null;try{return{success:!0,data:(await W(`wishlists/public/${e}/`)).data.wishlist}}catch(r){return t.value=((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to fetch public wishlist",{success:!1,error:t.value}}finally{m.value=!1}}async function J(e,a){var s,r;m.value=!0,t.value=null;try{return{success:!0,data:(await W(`wishlists/@${e}/${a}/`)).data.wishlist}}catch(u){return t.value=((r=(s=u.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to fetch public wishlist",{success:!1,error:t.value}}finally{m.value=!1}}async function K(e){var a,s,r,u;h.value=!0,t.value=null;try{const l=await W(`wishlists/user/${e}/`);return l.data.success?{success:!0,data:l.data.wishlists||[],user:{username:l.data.username,fullName:l.data.user_full_name,totalWishlists:l.data.total_wishlists},message:l.data.message}:{success:!1,error:l.data.message||"User has no public wishlists"}}catch(l){return t.value=((s=(a=l.response)==null?void 0:a.data)==null?void 0:s.message)||((u=(r=l.response)==null?void 0:r.data)==null?void 0:u.error)||"Failed to fetch user wishlists",{success:!1,error:t.value}}finally{h.value=!1}}async function N(){var e,a;h.value=!0,t.value=null;try{const s=await W("wishlists/public/");return b.value=s.data.wishlists||[],{success:!0,data:b.value}}catch(s){return t.value=((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.error)||"Failed to search public wishlists",{success:!1,error:t.value}}finally{h.value=!1}}async function V(e){var a,s;n.value=!0,t.value=null;try{return{success:!0,message:(await F(`wishlists/${e}/favorite/`,{})).data.message}}catch(r){return t.value=((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to favorite wishlist",{success:!1,error:t.value}}finally{n.value=!1}}async function k(e){var a,s;n.value=!0,t.value=null;try{const r=await $(`wishlists/${e}/unfavorite/`);return g.value=g.value.filter(u=>u.wishlist.id!==e),{success:!0,message:r.data.message}}catch(r){return t.value=((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to unfavorite wishlist",{success:!1,error:t.value}}finally{n.value=!1}}async function z(){var e,a;h.value=!0,t.value=null;try{const s=await W("wishlists/favorites/");return g.value=s.data.favorite_wishlists||[],{success:!0,data:g.value}}catch(s){return t.value=((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.error)||"Failed to fetch favorite wishlists",{success:!1,error:t.value}}finally{h.value=!1}}async function A(e,a){var s,r,u,l,o;n.value=!0,t.value=null;try{const c=await ue(`wishlists/${e}/shipping/`,a),v=c.data.wishlist,f=i.value.findIndex(w=>w.id===e);return f!==-1&&(i.value[f]=v),((s=d.value)==null?void 0:s.id)===e&&(d.value=v),{success:!0,message:c.data.message,data:v}}catch(c){return t.value=((u=(r=c.response)==null?void 0:r.data)==null?void 0:u.details)||((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.error)||"Failed to update shipping info",{success:!1,error:t.value}}finally{n.value=!1}}function M(e){return i.value.find(a=>a.id===e)||null}function Q(e){return i.value.some(a=>{var s;return(s=a.items)==null?void 0:s.some(r=>r.woocommerce_product_id===e)})}function X(e){return i.value.filter(a=>{var s;return(s=a.items)==null?void 0:s.some(r=>r.woocommerce_product_id===e)})}function Y(e){const a=B.find(s=>s.value===e);return a?a.label:e}function Z(e){const a=B.find(s=>s.value===e);return a?a.color:"text-gray-500"}function ee(){d.value=null}function se(){t.value=null}function ae(){return{total:x.value,active:_.value.length,public:P.value.length,private:S.value.length,total_value:U.value,total_items:q.value,favorites:g.value.length}}return{wishlists:i,currentWishlist:d,publicWishlists:b,favoriteWishlists:g,isLoading:h,isLoadingWishlist:m,isUpdating:n,error:t,totalWishlists:x,activeWishlists:_,publicUserWishlists:P,privateWishlists:S,hasWishlists:L,totalWishlistValue:U,totalWishlistItems:q,fetchWishlists:O,fetchWishlist:T,createWishlist:j,updateWishlist:E,deleteWishlist:H,addWooCommerceProductToWishlist:I,removeWooCommerceProductFromWishlist:R,refreshWishlistProducts:D,fetchPublicWishlistByUUID:G,fetchPublicWishlistByUsername:J,fetchWishlistsByUsername:K,searchPublicWishlists:N,favoriteWishlist:V,unfavoriteWishlist:k,fetchFavoriteWishlists:z,updateWishlistShipping:A,getWishlistById:M,isWooCommerceProductInWishlist:Q,getWishlistsWithProduct:X,getPriorityLabel:Y,getPriorityColor:Z,clearCurrentWishlist:ee,clearError:se,getWishlistStatistics:ae}});export{ce as u};
