import{r as w,D as S,c as o,h as x,o as s,a as r,e as h,F as I,g as O,t as c,s as C,k as V,p as E,u as U,M as q,i as B,d as G,K as Z}from"../index.js";import{u as z}from"./cartStore-VCuiRpOe.js";import{u as K}from"./authStore-tY-7-Xic.js";import{u as R}from"./profileStore-DZizYbaJ.js";import{u as Y}from"./wishlistStore-2Sa37WF2.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={class:"bg-white rounded-2xl p-6 max-w-md w-full mx-4 shadow-xl"},X={key:0,class:"flex justify-center py-8"},tt={key:1,class:"space-y-2 max-h-96 overflow-y-auto"},et=["onClick","disabled"],ot={class:"flex items-center justify-between"},st={class:"flex-1"},rt={class:"font-semibold text-gray-900"},dt={class:"text-xs text-gray-500"},at={key:0,class:"animate-spin h-5 w-5 text-brand-pink-medium",fill:"none",viewBox:"0 0 24 24"},it={key:2,class:"text-center py-8"},lt={key:3,class:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg"},nt={class:"text-sm text-red-800"},ct={class:"flex gap-3 mt-6"},ut=["disabled"],pt={__name:"WishlistSelector",props:{show:{type:Boolean,default:!1},productId:{type:Number,required:!0}},emits:["close","added","create-wishlist"],setup(l,{emit:_}){const t=l,g=_,m=Y(),b=w(!1),u=w(null),v=w(null);S(()=>t.show,async n=>{n&&(v.value=null,await m.fetchWishlists())});const $=async n=>{if(!b.value){b.value=!0,u.value=n,v.value=null;try{const i=await m.addWooCommerceProductToWishlist(n,t.productId,"","medium");i.success?(g("added",n),g("close")):v.value=i.error||"Failed to add product to wishlist"}catch(i){v.value="An error occurred while adding the product",console.error("Error adding to wishlist:",i)}finally{b.value=!1,u.value=null}}};return(n,i)=>l.show?(s(),o("div",{key:0,class:"fixed inset-0 bg-white/40 backdrop-blur-md flex items-center justify-center z-50",onClick:i[2]||(i[2]=C(p=>n.$emit("close"),["self"]))},[r("div",Q,[i[6]||(i[6]=r("h2",{class:"text-xl font-bold text-gray-900 mb-4"},"Add to Wishlist",-1)),h(m).isLoading?(s(),o("div",X,[...i[3]||(i[3]=[r("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-brand-pink-medium"},null,-1)])])):h(m).wishlists.length>0?(s(),o("div",tt,[(s(!0),o(I,null,O(h(m).wishlists,p=>(s(),o("button",{key:p.id,onClick:y=>$(p.id),disabled:b.value,class:"w-full text-left p-3 border-2 border-gray-200 rounded-lg hover:border-brand-pink-medium hover:bg-brand-pink-medium/5 transition-all disabled:opacity-50"},[r("div",ot,[r("div",st,[r("p",rt,c(p.name),1),r("p",dt,c(p.total_items)+" items",1)]),b.value&&u.value===p.id?(s(),o("svg",at,[...i[4]||(i[4]=[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):x("",!0)])],8,et))),128))])):(s(),o("div",it,[i[5]||(i[5]=r("p",{class:"text-gray-500 mb-4"},"You don't have any wishlists yet",-1)),r("button",{onClick:i[0]||(i[0]=p=>n.$emit("create-wishlist")),class:"px-4 py-2 border-2 border-brand-pink-medium text-brand-pink-medium bg-white rounded-lg hover:bg-brand-pink-medium hover:text-white transition-colors"}," Create Wishlist ")])),v.value?(s(),o("div",lt,[r("p",nt,c(v.value),1)])):x("",!0),r("div",ct,[r("button",{onClick:i[1]||(i[1]=p=>n.$emit("close")),disabled:b.value,class:"flex-1 px-4 py-2 border-2 border-gray-300 text-gray-700 bg-white rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50"}," Cancel ",8,ut)])])])):x("",!0)}},ht="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3cpath%20d='M19.4626%203.99415C16.7809%202.34923%2014.4404%203.01211%2013.0344%204.06801C12.4578%204.50096%2012.1696%204.71743%2012%204.71743C11.8304%204.71743%2011.5422%204.50096%2010.9656%204.06801C9.55962%203.01211%207.21909%202.34923%204.53744%203.99415C1.01807%206.15294%200.221721%2013.2749%208.33953%2019.2834C9.88572%2020.4278%2010.6588%2021%2012%2021C13.3412%2021%2014.1143%2020.4278%2015.6605%2019.2834C23.7783%2013.2749%2022.9819%206.15294%2019.4626%203.99415Z'%20fill='%23DA9DFF'/%3e%3c/svg%3e",mt="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3cpath%20d='M19.4626%203.99415C16.7809%202.34923%2014.4404%203.01211%2013.0344%204.06801C12.4578%204.50096%2012.1696%204.71743%2012%204.71743C11.8304%204.71743%2011.5422%204.50096%2010.9656%204.06801C9.55962%203.01211%207.21909%202.34923%204.53744%203.99415C1.01807%206.15294%200.221721%2013.2749%208.33953%2019.2834C9.88572%2020.4278%2010.6588%2021%2012%2021C13.3412%2021%2014.1143%2020.4278%2015.6605%2019.2834C23.7783%2013.2749%2022.9819%206.15294%2019.4626%203.99415Z'%20stroke='black'%20stroke-width='2'%20stroke-linecap='round'/%3e%3c/svg%3e",gt="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M3.5%2010C3.5%206.22876%203.5%204.34315%204.7448%203.17157C5.98959%202%207.99306%202%2012%202H12.7727C16.0339%202%2017.6645%202%2018.7969%202.79784C19.1214%203.02643%2019.4094%203.29752%2019.6523%203.60289C20.5%204.66867%2020.5%206.20336%2020.5%209.27273V11.8182C20.5%2014.7814%2020.5%2016.2629%2020.0311%2017.4462C19.2772%2019.3486%2017.6829%2020.8491%2015.6616%2021.5586C14.4044%2022%2012.8302%2022%209.68182%2022C7.88275%2022%206.98322%2022%206.26478%2021.7478C5.10979%2021.3424%204.19875%2020.4849%203.76796%2019.3979C3.5%2018.7217%203.5%2017.8751%203.5%2016.1818V10Z'%20fill='%23DA9DFF'%20stroke='white'%20stroke-width='1.5'%20stroke-linejoin='round'/%3e%3cpath%20d='M20.5%2012C20.5%2013.8409%2019.0076%2015.3333%2017.1667%2015.3333C16.5009%2015.3333%2015.716%2015.2167%2015.0686%2015.3901C14.4935%2015.5442%2014.0442%2015.9935%2013.8901%2016.5686C13.7167%2017.216%2013.8333%2018.0009%2013.8333%2018.6667C13.8333%2020.5076%2012.3409%2022%2010.5%2022'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M8%207H15'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M8%2011H11'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",vt="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M3.5%2010C3.5%206.22876%203.5%204.34315%204.7448%203.17157C5.98959%202%207.99306%202%2012%202H12.7727C16.0339%202%2017.6645%202%2018.7969%202.79784C19.1214%203.02643%2019.4094%203.29752%2019.6523%203.60289C20.5%204.66867%2020.5%206.20336%2020.5%209.27273V11.8182C20.5%2014.7814%2020.5%2016.2629%2020.0311%2017.4462C19.2772%2019.3486%2017.6829%2020.8491%2015.6616%2021.5586C14.4044%2022%2012.8302%2022%209.68182%2022C7.88275%2022%206.98322%2022%206.26478%2021.7478C5.10979%2021.3424%204.19875%2020.4849%203.76796%2019.3979C3.5%2018.7217%203.5%2017.8751%203.5%2016.1818V10Z'%20stroke='%2314181F'%20stroke-width='1.5'%20stroke-linejoin='round'/%3e%3cpath%20d='M20.5%2012C20.5%2013.8409%2019.0076%2015.3333%2017.1667%2015.3333C16.5009%2015.3333%2015.716%2015.2167%2015.0686%2015.3901C14.4935%2015.5442%2014.0442%2015.9935%2013.8901%2016.5686C13.7167%2017.216%2013.8333%2018.0009%2013.8333%2018.6667C13.8333%2020.5076%2012.3409%2022%2010.5%2022'%20stroke='%2314181F'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M8%207H15'%20stroke='%2314181F'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M8%2011H11'%20stroke='%2314181F'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",ft={class:"product-card bg-white rounded-2xl md:rounded-3xl overflow-hidden shadow-sm hover:shadow-xl transition-all duration-300"},kt={class:"product-image relative bg-white p-3 md:p-4"},wt=["src","alt"],bt={key:0,class:"product-actions absolute top-4 md:top-5 lg:top-6 right-4 md:right-5 lg:right-6 flex space-x-2 md:space-x-2.5 lg:space-x-3"},yt=["title"],Ct=["src"],xt=["disabled","title"],$t=["src"],_t={class:"product-info px-3 md:px-4 pb-3 md:pb-4"},Ft={class:"product-footer flex flex-col gap-3 md:gap-4 mt-2 md:mt-3"},Pt={class:"price-section"},At={key:1,class:"product-price text-xl md:text-2xl font-medium text-gray-900 font-poppins"},Bt={key:0,class:"product-buttons flex gap-2 md:gap-2.5 w-full"},St=["disabled"],It={key:0},Mt={key:1},Wt={key:2},Tt={key:3},jt={key:1,class:"product-buttons flex gap-2 md:gap-2.5 w-full"},Dt=["disabled"],Lt={key:0},Ht={key:1},Nt={key:2},Ot={key:3},Vt=["disabled"],Et={key:0},Ut={key:1},qt={key:2},Gt={key:3},Zt={__name:"ProductCard",props:{product:{type:Object,required:!0},isInWishlist:{type:Boolean,default:!1},isInList:{type:Boolean,default:!1},isInFavorites:{type:Boolean,default:!1},giftMode:{type:Boolean,default:!1}},emits:["navigate-to-product","add-to-cart","toggle-wishlist","toggle-list","favorite-updated"],setup(l,{emit:_}){const t=l,g=_,m=V(),{t:b}=E(),u=z(),v=K(),$=R(),n=U(),i=q(),p=w(!1),y=w(t.isInFavorites),F=w(!1),f=w(!1),k=w(!1),M=B(()=>{const e=parseFloat(t.product.converted_price||t.product.price)||0;return i.formatPrice(e)}),P=B(()=>parseFloat(t.product.converted_price||t.product.price)||0);S(()=>t.isInFavorites,e=>{y.value=e});const A=async e=>{if(f.value)return{available:!1,checking:!0};f.value=!0;try{console.log(`📦 [ProductCard] Verificando stock para producto ${e}...`);const a=await Z(`products/woocommerce/products/${e}/stock/`);if(a.data.success){const d=a.data.stock;return console.log("✅ [ProductCard] Stock verificado:",{status:d.status,quantity:d.quantity,available:d.available}),!d.available||d.status==="outofstock"?(k.value=!0,{available:!1,stock:d}):(k.value=!1,{available:!0,stock:d})}return{available:!1}}catch(a){return console.error("❌ [ProductCard] Error verificando stock:",a),{available:t.product.stock_status==="instock"}}finally{f.value=!1}},W=async()=>{if(!v.isLoggedIn){m.push({name:`Login-${n.locale}`});return}F.value=!0;try{y.value?(await $.removeProductFromFavorites(t.product.id)).success&&(y.value=!1,g("favorite-updated",{productId:t.product.id,isFavorited:!1})):(await $.addProductToFavorites(t.product.id)).success&&(y.value=!0,g("favorite-updated",{productId:t.product.id,isFavorited:!0}))}catch(e){console.error("Error toggling favorite:",e)}finally{F.value=!1}},T=()=>{if(!v.isLoggedIn){m.push({name:`Login-${n.locale}`});return}p.value=!0},j=e=>{console.log(`Product ${t.product.id} added to wishlist ${e}`)},D=()=>{p.value=!1,m.push({name:`ProfileWishlist-${n.locale}`})},L=async()=>{var a;if(console.log("🔵 [ProductCard] handleBuyNow clicked for product:",t.product.id),t.product.type==="variable"){g("navigate-to-product",t.product.id);return}const e=await A(t.product.id);if(!e.available){console.warn("⚠️ [ProductCard] Producto sin stock, no se puede comprar");return}try{const d=u.addToCart(t.product.id,1,{name:t.product.name,price:P.value,image:t.product.images&&t.product.images.length>0?t.product.images[0].src:null,stock_status:((a=e.stock)==null?void 0:a.status)||t.product.stock_status,variation_id:null});console.log("🔵 [ProductCard] handleBuyNow result:",d),d.success&&m.push({name:`Checkout-${n.locale}`})}catch(d){console.error("Error al comprar el producto:",d)}},H=async()=>{var a;if(console.log("🟢 [ProductCard] handleAddToCart clicked for product:",t.product.id),t.product.type==="variable"){g("navigate-to-product",t.product.id);return}const e=await A(t.product.id);if(!e.available){console.warn("⚠️ [ProductCard] Producto sin stock, no se puede agregar al carrito");return}try{const d=u.addToCart(t.product.id,1,{name:t.product.name,price:P.value,image:t.product.images&&t.product.images.length>0?t.product.images[0].src:null,stock_status:((a=e.stock)==null?void 0:a.status)||t.product.stock_status,variation_id:null});console.log("🟢 [ProductCard] handleAddToCart result:",d),d.success&&g("add-to-cart",t.product)}catch(d){console.error("Error adding product to cart:",d)}},N=async()=>{var a;if(console.log("🎁 [ProductCard] handleBuyAsGift clicked for product:",t.product.id),t.product.type==="variable"){g("navigate-to-product",t.product.id);return}const e=await A(t.product.id);if(!e.available){console.warn("⚠️ [ProductCard] Producto sin stock, no se puede comprar como regalo");return}try{const d=u.addToCart(t.product.id,1,{name:t.product.name,price:P.value,image:t.product.images&&t.product.images.length>0?t.product.images[0].src:null,stock_status:((a=e.stock)==null?void 0:a.status)||t.product.stock_status,variation_id:null});console.log("🎁 [ProductCard] handleBuyAsGift result:",d),d.success&&m.push({name:`Checkout-${n.locale}`})}catch(d){console.error("Error al comprar el producto como regalo:",d)}};return(e,a)=>(s(),o("div",ft,[r("div",kt,[r("img",{src:l.product.images&&l.product.images.length>0?l.product.images[0].src:"https://images.unsplash.com/photo-1583394838336-acd977736f90?w=300&h=300&fit=crop&crop=center",alt:l.product.name,class:"w-full h-40 md:h-44 lg:h-48 object-contain cursor-pointer",onClick:a[0]||(a[0]=d=>e.$emit("navigate-to-product",l.product.id))},null,8,wt),l.giftMode?x("",!0):(s(),o("div",bt,[r("button",{onClick:C(T,["stop"]),class:"action-btn bg-white p-2 md:p-2.5 rounded-lg md:rounded-xl shadow-md hover:shadow-lg transition-all duration-200 hover:scale-110",title:e.$t("products.product.addToList")},[r("img",{src:l.isInList?h(gt):h(vt),alt:"List icon",class:"w-5 h-5 md:w-6 md:h-6"},null,8,Ct)],8,yt),r("button",{onClick:C(W,["stop"]),disabled:F.value,class:"action-btn bg-white p-2 md:p-2.5 rounded-lg md:rounded-xl shadow-md hover:shadow-lg transition-all duration-200 hover:scale-110 disabled:opacity-50 disabled:cursor-not-allowed",title:y.value?e.$t("products.product.removeFromFavorites"):e.$t("products.product.addToFavorites")},[r("img",{src:y.value?h(ht):h(mt),alt:"Heart icon",class:"w-5 h-5 md:w-6 md:h-6"},null,8,$t)],8,xt)]))]),r("div",_t,[r("h3",{class:"product-title text-sm md:text-base font-normal text-gray-900 mb-2 md:mb-3 cursor-pointer hover:text-brand-pink-dark transition-colors font-comfortaa line-clamp-2",onClick:a[1]||(a[1]=d=>e.$emit("navigate-to-product",l.product.id))},c(l.product.name),1),r("div",Ft,[r("div",Pt,[l.product.type==="variable"?(s(),o("span",{key:0,class:"product-price text-lg md:text-xl font-medium text-brand-pink-dark font-poppins italic cursor-pointer hover:text-brand-pink transition-colors",onClick:a[2]||(a[2]=d=>e.$emit("navigate-to-product",l.product.id))},c(e.$t("products.product.findMe")||"Find me ✨"),1)):(s(),o("span",At,c(M.value),1))]),l.product.type!=="variable"?(s(),o(I,{key:0},[l.giftMode?(s(),o("div",Bt,[r("button",{onClick:C(N,["stop"]),disabled:k.value||h(u).isUpdating||f.value,class:"btn-gift text-white px-3 md:px-4 py-2 md:py-2.5 rounded-full text-xs md:text-sm font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-poppins hover:opacity-90 whitespace-nowrap flex-1",style:{"background-color":"#DA9DFF"}},[f.value?(s(),o("span",It,"⏳")):k.value?(s(),o("span",Mt,c(e.$t("products.product.outOfStock")||"Out of stock"),1)):h(u).isUpdating?(s(),o("span",Wt,c(e.$t("products.product.adding")||"Adding..."),1)):(s(),o("span",Tt,c(e.$t("products.product.buyAsGift")||"Buy as Gift"),1))],8,St)])):(s(),o("div",jt,[r("button",{onClick:C(L,["stop"]),disabled:k.value||h(u).isUpdating||f.value,class:"btn-buy text-white px-3 md:px-4 py-2 md:py-2.5 rounded-full text-xs md:text-sm font-semibold transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-poppins hover:opacity-90 flex-1",style:{"background-color":"#DA9DFF"}},[f.value?(s(),o("span",Lt,"⏳")):k.value?(s(),o("span",Ht,c(e.$t("products.product.outOfStock")||"Out of stock"),1)):h(u).isUpdating?(s(),o("span",Nt,c(e.$t("products.product.adding")||"Adding..."),1)):(s(),o("span",Ot,c(e.$t("products.product.buyNow")||"Buy now"),1))],8,Dt),r("button",{onClick:C(H,["stop"]),disabled:k.value||h(u).isUpdating||f.value,class:"btn-cart text-white px-3 md:px-4 py-2 md:py-2.5 rounded-full text-xs md:text-sm font-semibold transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-poppins hover:opacity-90 flex-1",style:{"background-color":"#DA9DFF"}},[f.value?(s(),o("span",Et,"⏳")):k.value?(s(),o("span",Ut,c(e.$t("products.product.outOfStock")||"Out of stock"),1)):h(u).isUpdating?(s(),o("span",qt,c(e.$t("products.product.adding")||"Adding..."),1)):(s(),o("span",Gt,c(e.$t("products.product.addToCart")||"Add to cart"),1))],8,Vt)]))],64)):x("",!0)])]),G(pt,{show:p.value,"product-id":l.product.id,onClose:a[3]||(a[3]=d=>p.value=!1),onAdded:j,onCreateWishlist:D},null,8,["show","product-id"])]))}},Xt=J(Zt,[["__scopeId","data-v-fd69de83"]]);export{Xt as P,pt as _};
