import{L as Ae,u as De,r as v,i as C,D as j,j as Ue,k as Oe,M as Te,c as l,o as n,a as e,h as d,t as r,v as m,N as me,b,x as w,F as V,E as le,O as $e,g as Y,e as x,P as Ne,n as Le}from"../index.js";import{u as Ve}from"./cartStore-VCuiRpOe.js";import{u as xe}from"./authStore-BFns-WxD.js";import{u as Re}from"./crushStore-CDiYl-yT.js";import{u as He}from"./paymentStore-B__dCdAU.js";import{u as Me}from"./productStore-zfTZaC62.js";import{u as qe}from"./useAlert-P81MXwWp.js";import{C as Ye,S as Ke}from"./state-DRCieogr.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-DjCFsGER.js";const ze={class:"checkout-view"},We={class:"checkout-container"},Fe={class:"shipping-section"},Ge={class:"shipping-card"},je={class:"section-title"},Je={class:"shipping-type"},Xe={class:"radio-label"},Ze={class:"radio-label"},Qe={class:"form-group"},eo={for:"email"},oo=["placeholder"],ao={class:"form-group"},to={class:"form-group"},so={class:"form-group"},ro={class:"form-group"},lo={class:"form-group"},no={key:0,class:"city-shipping-info"},io={class:"form-row"},uo={class:"form-group"},co=["value"],po={class:"form-group"},vo={class:"form-group"},mo={class:"phone-input"},ho=["value"],go={class:"form-group"},fo={class:"form-group"},_o={for:"username"},yo={class:"username-search-container"},Po=["placeholder"],Co={key:0,class:"username-search-results"},bo=["onMousedown"],wo=["src","alt"],So={class:"search-user-info"},Eo={class:"search-username"},ko={key:0,class:"search-crush-label"},Io={key:0,class:"gift-field-description"},Ao={class:"highlight"},Do={class:"form-group"},Uo={for:"note"},Oo=["placeholder"],To={class:"form-group payment-button-section"},$o=["disabled"],No={key:0,class:"payment-error"},Lo={key:2,id:"paypal-section",class:"paypal-section"},Vo={class:"summary-section"},xo={class:"summary-card"},Ro={class:"section-title"},Ho={key:0,class:"loading-state"},Mo={key:1,class:"products-list"},qo={class:"product-image"},Yo=["src","alt"],Ko={class:"product-details"},Bo={class:"product-name"},zo={key:0,class:"product-meta"},Wo={key:1,class:"product-meta"},Fo={key:2,class:"product-meta"},Go={key:3,class:"product-meta variation-id"},jo={class:"product-quantity"},Jo={class:"product-price"},Xo={class:"discount-section"},Zo={key:0,class:"discount-input"},Qo=["disabled"],ea=["disabled"],oa={key:1,class:"discount-applied"},aa={class:"discount-applied-content"},ta={class:"discount-code-badge"},sa={class:"discount-percentage"},ra={key:2,class:"discount-error"},la={class:"totals-section"},na={class:"total-row"},ia={class:"subtotal-values"},ua={key:0,class:"original-subtotal"},ca={class:"total-row"},da={class:"total-value"},pa={key:0,class:"shipping-city-note"},va={key:1,class:"shipping-city-note"},ma={key:0,class:"total-row discount-row"},ha={class:"discount-label"},ga={class:"total-value discount-value"},fa={class:"total-row tax-row"},_a={class:"total-value tax-included-value"},ya={class:"final-total"},Pa={class:"total-row"},Ca={class:"total-label"},ba={class:"total-amount"},wa={class:"tax-note"},he=48500,Sa={__name:"CheckoutView",setup(Ea){const J=Oe(),O=Ae(),E=a=>O.formatPrice(a),H=a=>O.currentCurrency==="USD"?Math.round(a/4e3*100)/100:a,k=Ve(),T=xe(),_=Re(),ne=De(),$=He(),ge=Me(),{showSuccess:ie,showError:y,showLoading:ue,closeAlert:K}=qe(),fe=Ye.getAllCountries().map(a=>({...a,flag:a.flag||"üè≥Ô∏è"})),_e=[{code:"CO",dial_code:"+57",flag:"üá®üá¥",name:"Colombia"}],h=v("me"),s=v({email:"",fullName:"",country:"CO",address1:"",address2:"",city:"",state:"",zipCode:"",phoneCode:"+57",phone:"",additionalDetails:"",username:"",note:""}),I=v(""),c=v(null),N=v(""),M=v(!1),S=v(""),X=v(!1),Z=v(!1),A=v(null),ce=v(!1),D=v(""),L=v(!1),p=v(null);let U=null;const B=v(null),Q=v(null),ye=C(()=>Ke.getStatesOfCountry("CO")),Pe=C(()=>k.items),ee=C(()=>T.isLoggedIn&&T.username),Ce=async a=>{if(!a||!a.trim()){_.clearSearch();return}try{await _.searchUsers(a.trim(),5)}catch(o){console.error("Error searching users:",o)}},de=a=>{console.log("üë§ [SELECT USER] Usuario seleccionado:",a),p.value=a,L.value=!1,_.clearSearch(),U&&(clearTimeout(U),U=null),s.value.username=`@${a.username}`,D.value=`@${a.username}`,console.log("üí∞ [SELECT USER] Costo de env√≠o del usuario:",a.shipping_cost)};j(D,a=>{if(s.value.username=a,U&&clearTimeout(U),!a.trim()){_.clearSearch(),L.value=!1,p.value=null;return}if(p.value&&a===`@${p.value.username}`){console.log("‚è≠Ô∏è [WATCH] Usuario ya seleccionado, no buscar de nuevo");return}U=setTimeout(async()=>{await Ce(a),L.value=_.searchResults.length>0},300)}),j(h,a=>{a!=="gift"&&(D.value="",L.value=!1,p.value=null,_.clearSearch())}),j(()=>s.value.username,a=>{h.value==="gift"&&a!==D.value&&(D.value=a)});const be=async()=>{ce.value=!0;try{console.log(`üì¶ [DROPSHIPPING] Consultando producto ${he}...`);const a=await ge.fetchWooProduct(he);a.success&&a.data?(A.value=a.data,console.log("‚úÖ [DROPSHIPPING] Producto cargado:",{id:a.data.id,name:a.data.name,price:a.data.price})):console.error("‚ùå [DROPSHIPPING] Error al cargar producto:",a.error)}catch(a){console.error("‚ùå [DROPSHIPPING] Error inesperado:",a)}finally{ce.value=!1}},q=C(()=>k.totalPrice),oe=C(()=>{if(h.value==="me"){const a=!!(s.value.email&&s.value.fullName&&s.value.address1&&s.value.city&&s.value.state&&s.value.zipCode&&s.value.phone);return a||console.log("üîç [VALIDATION] Campos faltantes:",{email:!!s.value.email,fullName:!!s.value.fullName,address1:!!s.value.address1,city:!!s.value.city,state:!!s.value.state,zipCode:!!s.value.zipCode,phone:!!s.value.phone}),a}return h.value==="gift"?!!(s.value.email&&s.value.username):!1}),we=async()=>{var a,o,t,i,g,u,f;S.value="";try{if(console.log("üì¶ [CHECKOUT] Preparando datos para pago..."),!oe.value){S.value="Por favor completa todos los campos obligatorios",await y("Completa todos los campos obligatorios antes de continuar.","‚ö†Ô∏è Campos Incompletos");return}if(!k.items||k.items.length===0){S.value="El carrito est√° vac√≠o",await y("Tu carrito est√° vac√≠o.","üõí Carrito Vac√≠o");return}const G=fe.find(P=>P.isoCode===s.value.country),ve=G?G.name:s.value.country,re=k.items.map(P=>({woocommerce_product_id:P.product_id||P.id,woocommerce_variation_id:P.variation_id||null,product_name:P.name,quantity:P.quantity,unit_price:parseFloat(P.price),attributes:P.attributes||null}));A.value&&(re.push({woocommerce_product_id:A.value.id,woocommerce_variation_id:null,product_name:A.value.name,quantity:1,unit_price:parseFloat(A.value.price),attributes:null}),console.log("üì¶ [DROPSHIPPING] Producto agregado a items"));let R;h.value==="gift"?(R={items:re,customer_email:s.value.email,customer_name:ee.value?`${((a=T.user)==null?void 0:a.first_name)||""} ${((o=T.user)==null?void 0:o.last_name)||""}`.trim()||T.username:s.value.email,receiver_username:s.value.username.replace("@",""),gift_message:s.value.note||"",is_gift:!0,shipping:z.value,total:se.value,is_from_wishlist:!!B.value,wishlist_id:B.value||null,wishlist_name:Q.value||null,shipping_address:((t=p.value)==null?void 0:t.address)||"Direcci√≥n del destinatario",shipping_city:((i=p.value)==null?void 0:i.city)||"Ciudad",shipping_state:((g=p.value)==null?void 0:g.state)||"Departamento",shipping_postal_code:((u=p.value)==null?void 0:u.postal_code)||"00000",shipping_country:ve,phone_number:((f=p.value)==null?void 0:f.phone)||"+57 300 0000000"},ee.value&&(R.sender_username=T.username)):R={items:re,customer_email:s.value.email,customer_name:s.value.fullName,shipping_address:s.value.address1,shipping_address_line_2:s.value.address2||"",shipping_city:s.value.city,shipping_state:s.value.state,shipping_postal_code:s.value.zipCode,shipping_country:ve,phone_number:`${s.value.phoneCode} ${s.value.phone}`,notes:s.value.additionalDetails||"",shipping:z.value,total:se.value},console.log("üì§ [CHECKOUT] Datos de orden preparados:",R),O.currentCurrency==="COP"?await Se(R):(sessionStorage.setItem("checkout_order_data",JSON.stringify(R)),X.value=!0,setTimeout(()=>{const P=document.getElementById("paypal-section");P&&P.scrollIntoView({behavior:"smooth",block:"center"})},100))}catch(G){console.error("‚ùå [CHECKOUT] Error al preparar datos:",G),S.value="Error al preparar la orden",await y("Error al preparar la orden.","‚ùå Error")}},Se=async a=>{try{ue("Creando transacci√≥n...","üí≥ Wompi"),console.log("üí≥ [WOMPI] Iniciando pago...",a);const o=await $.createWompiTransaction(a);if(K(),!o.success){S.value=o.error||"Error al crear transacci√≥n en Wompi",await y(S.value,"‚ùå Error en Wompi");return}console.log("‚úÖ [WOMPI] Transacci√≥n creada:",o.data),localStorage.setItem("wompi_transaction_id",o.data.transaction_id),localStorage.setItem("wompi_order_data",JSON.stringify(a)),window.location.href=o.data.payment_url}catch(o){K(),console.error("‚ùå [WOMPI] Error inesperado:",o),S.value="Error al procesar el pago con Wompi",await y(S.value,"‚ùå Error")}},Ee=async()=>new Promise(async(a,o)=>{if(window.paypal){console.log("üí≥ [PAYPAL] SDK ya est√° cargado"),Z.value=!0,a();return}const t=document.querySelector('script[src*="paypal.com/sdk/js"]');if(t){t.addEventListener("load",()=>{console.log("üí≥ [PAYPAL] SDK cargado desde script existente"),Z.value=!0,a()});return}console.log("üí≥ [PAYPAL] Obteniendo configuraci√≥n...");const i=await $.fetchPayPalConfig();if(!i.success){console.error("‚ùå [PAYPAL] Error al obtener configuraci√≥n"),o(new Error(i.error));return}const g=i.data;console.log("üí≥ [PAYPAL] Cargando SDK...");const u=document.createElement("script");u.src=`https://www.paypal.com/sdk/js?client-id=${g.client_id}&buyer-country=US&currency=${g.currency}&components=buttons&enable-funding=venmo,paylater,card`,u.setAttribute("data-sdk-integration-source","developer-studio"),u.onload=()=>{console.log("‚úÖ [PAYPAL] SDK cargado exitosamente"),Z.value=!0,a()},u.onerror=f=>{console.error("‚ùå [PAYPAL] Error al cargar SDK:",f),o(f)},document.head.appendChild(u)}),ke=()=>{if(!window.paypal){console.error("‚ùå [PAYPAL] SDK no est√° disponible");return}const a=document.getElementById("paypal-button-container");if(!a){console.error("‚ùå [PAYPAL] Contenedor no encontrado");return}a.innerHTML="";const o=sessionStorage.getItem("checkout_order_data");if(!o){console.error("‚ùå [PAYPAL] No hay datos de orden");return}const t=JSON.parse(o);window.paypal.Buttons({style:{layout:"vertical",color:"gold",shape:"rect",label:"paypal"},createOrder:async(i,g)=>{console.log("üí≥ [PAYPAL] Creando orden...");try{if(t.is_gift){const f=await $.sendGift(t);if(!f.success)throw new Error(f.error);return f.paypal_order_id}const u=await $.createPayPalOrder(t);if(!u.success)throw new Error(u.error);return u.paypal_order_id}catch(u){throw console.error("‚ùå [PAYPAL] Error al crear orden:",u),await y(u.message||"Error al crear orden","‚ùå Error"),u}},onApprove:async(i,g)=>{console.log("‚úÖ [PAYPAL] Pago aprobado");try{ue("Procesando tu pago...","üí≥ Procesando");const u={paypal_order_id:i.orderID,...t},f=await $.capturePayPalOrder(i.orderID,u);if(K(),!f.success)throw new Error(f.error);console.log("‚úÖ [PAYPAL] Pago procesado exitosamente"),await ie(`Tu orden ha sido creada exitosamente.

üìã Orden: ${f.order.order_number}
üí∞ Total: $${f.order.total}

Recibir√°s un email de confirmaci√≥n pronto.`,"üéâ ¬°Pago Exitoso!",{timer:8e3}),sessionStorage.removeItem("checkout_order_data"),k.clearCart(),$.clearPaymentState(),setTimeout(()=>{J.push({name:`Home-${ne.locale}`})},1e3)}catch(u){console.error("‚ùå [PAYPAL] Error al capturar pago:",u),K(),await y(u.message||"Error al procesar el pago","‚ùå Error")}},onCancel:i=>{console.log("‚ö†Ô∏è [PAYPAL] Pago cancelado"),y("Has cancelado el proceso de pago.","‚ö†Ô∏è Pago Cancelado",{timer:5e3})},onError:i=>{console.error("‚ùå [PAYPAL] Error:",i),y("Hubo un error con PayPal. Por favor intenta de nuevo.","‚ùå Error en PayPal")}}).render("#paypal-button-container")},pe=async()=>{var a,o;if(!I.value||!I.value.trim()){N.value="Por favor ingresa un c√≥digo de descuento";return}M.value=!0,N.value="";try{console.log("üéüÔ∏è [DISCOUNT] Validando c√≥digo:",I.value);const t=await $.validateDiscountCode(I.value.trim().toUpperCase());console.log("üéüÔ∏è [DISCOUNT] Respuesta:",t),t.success&&t.data.exists&&t.data.is_valid?(c.value={code:t.data.code,discount_percentage:parseFloat(t.data.discount_percentage)},await ie(`¬°C√≥digo aplicado! Descuento del ${t.data.discount_percentage}%`,"üéâ Descuento Aplicado"),console.log("‚úÖ [DISCOUNT] Descuento aplicado:",c.value)):(c.value=null,N.value=((a=t.data)==null?void 0:a.message)||t.error||"C√≥digo de descuento no v√°lido",await y(((o=t.data)==null?void 0:o.message)||t.error||"El c√≥digo ingresado no es v√°lido o ha expirado","‚ùå C√≥digo Inv√°lido"))}catch(t){console.error("‚ùå [DISCOUNT] Error al validar:",t),c.value=null,N.value="Error al validar el c√≥digo",await y("Hubo un error al validar el c√≥digo. Por favor intenta de nuevo.","‚ùå Error")}finally{M.value=!1}},Ie=()=>{c.value=null,I.value="",N.value="",console.log("üóëÔ∏è [DISCOUNT] Descuento removido")},z=C(()=>{if(h.value==="gift"&&p.value&&p.value.shipping_cost){const o=parseFloat(p.value.shipping_cost),t=H(o);return console.log(`üì¶ [SHIPPING] Costo del usuario destinatario: ${o} COP ‚Üí ${t} ${O.currentCurrency}`),t}const a=(s.value.city||"").toLowerCase().trim();if(!a)return H(15e3);switch(a){case"medell√≠n":case"medellin":return H(10500);case"san andr√©s isla":case"san andres isla":case"san andr√©s":case"san andres":case"santa catalina":case"providencia":return H(45e3);default:return H(15e3)}}),W=C(()=>{let a=z.value;if(A.value&&A.value.price){const o=parseFloat(A.value.price);a+=o,console.log(`üì¶ [DROPSHIPPING] Shipping mostrado: ${z.value} + ${o} = ${a}`)}return a}),ae=C(()=>F.value*(.19/1.19)),te=C(()=>{if(!c.value)return 0;const a=q.value*c.value.discount_percentage/100;return console.log("üéüÔ∏è [DISCOUNT] Monto calculado:",{subtotal:q.value,percentage:c.value.discount_percentage,discount:a}),a}),F=C(()=>q.value-te.value),se=C(()=>{const a=F.value+W.value;return console.log("üí∞ [TOTAL] C√°lculo:",{subtotal:q.value,discount:te.value,subtotal_after_discount:F.value,shipping:W.value,tax_included:ae.value,total:a}),a});return Ue(async()=>{if(k.loadCart(),k.isEmpty){J.push({name:`Cart-${ne.locale}`});return}const a=J.currentRoute.value;if(a.query.giftMode==="true"){if(h.value="gift",a.query.username){const o=a.query.username,t=o.startsWith("@")?o:`@${o}`;s.value.username=t,D.value=t;try{const i=o.replace("@","").trim();if(console.log("üîç [CHECKOUT] Buscando usuario autom√°ticamente:",i),await _.searchUsers(i,5),_.searchResults.length>0){const g=_.searchResults.find(u=>u.username.toLowerCase()===i.toLowerCase());g?(console.log("‚úÖ [CHECKOUT] Usuario encontrado autom√°ticamente:",g),de(g)):console.warn("‚ö†Ô∏è [CHECKOUT] No se encontr√≥ coincidencia exacta para:",i)}else console.warn("‚ö†Ô∏è [CHECKOUT] No se encontraron resultados para:",i)}catch(i){console.error("‚ùå [CHECKOUT] Error al buscar usuario autom√°ticamente:",i)}}a.query.wishlistId&&(B.value=parseInt(a.query.wishlistId),Q.value=a.query.wishlistName||null,console.log("üéÅ [WISHLIST] Compra desde wishlist:",{id:B.value,name:Q.value}))}await be()}),j(X,async a=>{if(a&&O.currentCurrency==="USD")try{await Ee(),setTimeout(()=>{ke()},100)}catch(o){console.error("‚ùå [PAYPAL] Error al inicializar:",o),await y("No se pudo cargar PayPal.","‚ùå Error")}}),Te(()=>{U&&clearTimeout(U),p.value=null,_.clearSearch()}),(a,o)=>(n(),l("div",ze,[e("div",We,[e("div",Fe,[e("div",Ge,[e("h2",je,r(a.$t("cart.checkout.shippingInformation")),1),e("div",Je,[e("label",Xe,[m(e("input",{type:"radio",name:"shipping-type",value:"me","onUpdate:modelValue":o[0]||(o[0]=t=>h.value=t),checked:""},null,512),[[me,h.value]]),e("span",null,r(a.$t("cart.checkout.shippingType.forMe")),1)]),e("label",Ze,[m(e("input",{type:"radio",name:"shipping-type",value:"gift","onUpdate:modelValue":o[1]||(o[1]=t=>h.value=t)},null,512),[[me,h.value]]),e("span",null,r(a.$t("cart.checkout.shippingType.forGift")),1)])]),e("div",Qe,[e("label",eo,[b(r(a.$t("cart.checkout.form.email"))+" ",1),o[18]||(o[18]=e("span",{class:"text-red-500"},"*",-1))]),m(e("input",{type:"email",id:"email","onUpdate:modelValue":o[2]||(o[2]=t=>s.value.email=t),placeholder:a.$t("cart.checkout.form.placeholders.email"),class:"form-input",required:""},null,8,oo),[[w,s.value.email]])]),h.value==="me"?(n(),l(V,{key:0},[e("div",ao,[o[19]||(o[19]=e("label",{for:"fullname"},[b("Full name "),e("span",{class:"text-red-500"},"*")],-1)),m(e("input",{type:"text",id:"fullname","onUpdate:modelValue":o[3]||(o[3]=t=>s.value.fullName=t),placeholder:"John Doe",class:"form-input",required:""},null,512),[[w,s.value.fullName]])]),e("div",to,[o[21]||(o[21]=e("label",{for:"country"},"Country",-1)),m(e("select",{id:"country","onUpdate:modelValue":o[4]||(o[4]=t=>s.value.country=t),class:"form-input form-select",disabled:""},[...o[20]||(o[20]=[e("option",{value:"CO"},"üá®üá¥ Colombia",-1)])],512),[[le,s.value.country]])]),e("div",so,[o[22]||(o[22]=e("label",{for:"address1"},[b("Address line 1 "),e("span",{class:"text-red-500"},"*")],-1)),m(e("input",{type:"text",id:"address1","onUpdate:modelValue":o[5]||(o[5]=t=>s.value.address1=t),placeholder:"123 Main Street",class:"form-input",required:""},null,512),[[w,s.value.address1]])]),e("div",ro,[o[23]||(o[23]=e("label",{for:"address2"},"Address line 2",-1)),m(e("input",{type:"text",id:"address2","onUpdate:modelValue":o[6]||(o[6]=t=>s.value.address2=t),placeholder:"Apt, suite, unit number, etc. (optional)",class:"form-input"},null,512),[[w,s.value.address2]])]),e("div",lo,[o[24]||(o[24]=e("label",{for:"city"},[b("Ciudad "),e("span",{class:"text-red-500"},"*")],-1)),m(e("input",{type:"text",id:"city","onUpdate:modelValue":o[7]||(o[7]=t=>s.value.city=t),placeholder:"Ej: Bogot√°, Medell√≠n, Cali...",class:"form-input",required:"",list:"colombia-cities"},null,512),[[w,s.value.city]]),o[25]||(o[25]=$e('<datalist id="colombia-cities" data-v-d63c3b11><option value="Medell√≠n" data-v-d63c3b11></option><option value="Bogot√°" data-v-d63c3b11></option><option value="Cali" data-v-d63c3b11></option><option value="Barranquilla" data-v-d63c3b11></option><option value="Cartagena" data-v-d63c3b11></option><option value="San Andr√©s Isla" data-v-d63c3b11></option><option value="Santa Catalina" data-v-d63c3b11></option><option value="Providencia" data-v-d63c3b11></option><option value="Bucaramanga" data-v-d63c3b11></option><option value="Pereira" data-v-d63c3b11></option><option value="Manizales" data-v-d63c3b11></option><option value="Ibagu√©" data-v-d63c3b11></option><option value="Villavicencio" data-v-d63c3b11></option><option value="Pasto" data-v-d63c3b11></option><option value="Neiva" data-v-d63c3b11></option></datalist>',1)),s.value.city?(n(),l("p",no,[e("span",null," üì¶ Costo de env√≠o: "+r(E(W.value)),1)])):d("",!0)]),e("div",io,[e("div",uo,[o[27]||(o[27]=e("label",{for:"state"},[b("Departamento "),e("span",{class:"text-red-500"},"*")],-1)),m(e("select",{id:"state","onUpdate:modelValue":o[8]||(o[8]=t=>s.value.state=t),class:"form-input form-select",required:""},[o[26]||(o[26]=e("option",{value:""},"Selecciona un departamento",-1)),(n(!0),l(V,null,Y(ye.value,t=>(n(),l("option",{key:t.isoCode,value:t.name},r(t.name),9,co))),128))],512),[[le,s.value.state]])]),e("div",po,[o[28]||(o[28]=e("label",{for:"zipcode"},[b("C√≥digo Postal "),e("span",{class:"text-red-500"},"*")],-1)),m(e("input",{type:"text",id:"zipcode","onUpdate:modelValue":o[9]||(o[9]=t=>s.value.zipCode=t),placeholder:"11001",class:"form-input",required:""},null,512),[[w,s.value.zipCode]])])]),e("div",vo,[o[29]||(o[29]=e("label",{for:"phone"},[b("Phone "),e("span",{class:"text-red-500"},"*")],-1)),e("div",mo,[m(e("select",{"onUpdate:modelValue":o[10]||(o[10]=t=>s.value.phoneCode=t),class:"phone-code",disabled:""},[(n(),l(V,null,Y(_e,t=>e("option",{key:t.code,value:t.dial_code},r(t.flag)+" "+r(t.dial_code),9,ho)),64))],512),[[le,s.value.phoneCode]]),m(e("input",{type:"tel",id:"phone","onUpdate:modelValue":o[11]||(o[11]=t=>s.value.phone=t),placeholder:"300 123 4567",class:"form-input phone-number",required:""},null,512),[[w,s.value.phone]])])]),e("div",go,[o[30]||(o[30]=e("label",{for:"additional"},"Additional address details (optional)",-1)),m(e("textarea",{id:"additional","onUpdate:modelValue":o[12]||(o[12]=t=>s.value.additionalDetails=t),placeholder:"Special delivery instructions, gate codes, building details, etc.",class:"form-textarea",rows:"3"},null,512),[[w,s.value.additionalDetails]])])],64)):d("",!0),h.value==="gift"?(n(),l(V,{key:1},[e("div",fo,[e("label",_o,[b(r(a.$t("cart.checkout.form.username"))+" ",1),o[31]||(o[31]=e("span",{class:"text-red-500"},"*",-1))]),e("div",yo,[m(e("input",{type:"text",id:"username","onUpdate:modelValue":o[13]||(o[13]=t=>D.value=t),placeholder:a.$t("cart.checkout.form.placeholders.searchUser"),class:"form-input username-search-input",autocomplete:"off",onFocus:o[14]||(o[14]=t=>L.value=x(_).searchResults.length>0),onBlur:o[15]||(o[15]=()=>a.setTimeout(()=>L.value=!1,200))},null,40,Po),[[w,D.value]]),L.value&&x(_).searchResults.length>0?(n(),l("div",Co,[(n(!0),l(V,null,Y(x(_).searchResults,t=>(n(),l("div",{key:t.id,class:"username-search-item",onMousedown:i=>de(t)},[e("img",{src:t.profile_picture||"https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=40",alt:t.username,class:"search-avatar"},null,8,wo),e("div",So,[e("span",Eo,"@"+r(t.username),1),t.is_crush?(n(),l("span",ko,"Crush")):d("",!0)])],40,bo))),128))])):d("",!0)]),ee.value?(n(),l("p",Io,[e("span",Ao,"@"+r(x(T).username),1),b(" "+r(a.$t("cart.checkout.form.help.username")),1)])):d("",!0)]),e("div",Do,[e("label",Uo,r(a.$t("cart.checkout.form.note")),1),m(e("textarea",{id:"note","onUpdate:modelValue":o[16]||(o[16]=t=>s.value.note=t),placeholder:a.$t("cart.checkout.form.placeholders.note"),class:"form-textarea",rows:"3"},null,8,Oo),[[w,s.value.note]])])],64)):d("",!0),e("div",To,[e("button",{onClick:we,disabled:!oe.value,class:"continue-payment-btn"},r(oe.value?x(O).currentCurrency==="COP"?"Pagar con Wompi ‚Üí":"Continuar al pago ‚Üí":"Completa todos los campos obligatorios"),9,$o),S.value?(n(),l("p",No,r(S.value),1)):d("",!0)]),X.value&&x(O).currentCurrency==="USD"?(n(),l("div",Lo,[...o[32]||(o[32]=[e("h3",{class:"paypal-title"},"Completa tu pago con PayPal",-1),e("div",{id:"paypal-button-container"},null,-1)])])):d("",!0)])]),e("div",Vo,[e("div",xo,[e("h2",Ro,r(a.$t("cart.checkout.form.orderSummary")),1),x(k).isUpdating?(n(),l("div",Ho,[...o[33]||(o[33]=[e("p",null,"Cargando productos...",-1)])])):(n(),l("div",Mo,[(n(!0),l(V,null,Y(Pe.value,t=>(n(),l("div",{key:t.id,class:"product-item"},[e("div",qo,[e("img",{src:t.image||"https://images.unsplash.com/photo-1560769629-975ec94e6a86?w=200",alt:t.name||"Product"},null,8,Yo)]),e("div",Ko,[e("h4",Bo,r(t.name||"Product"),1),t.color?(n(),l("p",zo,"Color: "+r(t.color),1)):d("",!0),t.size?(n(),l("p",Wo,"Talla: "+r(t.size),1)):d("",!0),t.attributes&&Object.keys(t.attributes).length>0?(n(),l("p",Fo,[(n(!0),l(V,null,Y(t.attributes,(i,g)=>(n(),l("span",{key:g},r(g)+": "+r(i),1))),128))])):d("",!0),t.variation_id?(n(),l("p",Go," Variaci√≥n: #"+r(t.variation_id),1)):d("",!0)]),e("div",jo,[e("span",null,r(t.quantity),1)]),e("div",Jo,r(E(t.price*t.quantity)),1)]))),128))])),e("div",Xo,[o[34]||(o[34]=e("h3",{class:"discount-title"},"C√≥digo de descuento",-1)),c.value?d("",!0):(n(),l("div",Zo,[m(e("input",{type:"text","onUpdate:modelValue":o[17]||(o[17]=t=>I.value=t),placeholder:"Ingresa tu c√≥digo",class:"form-input",disabled:M.value,onKeyup:Ne(pe,["enter"])},null,40,Qo),[[w,I.value]]),e("button",{onClick:pe,disabled:M.value||!I.value.trim(),class:"validate-btn"},r(M.value?"Validando...":"Validar"),9,ea)])),c.value?(n(),l("div",oa,[e("div",aa,[e("span",ta,r(c.value.code),1),e("span",sa,"-"+r(c.value.discount_percentage)+"%",1)]),e("button",{onClick:Ie,class:"remove-discount-btn",title:"Remover descuento"}," ‚úï ")])):d("",!0),N.value&&!c.value?(n(),l("p",ra,r(N.value),1)):d("",!0)]),e("div",la,[e("div",na,[e("span",null,r(a.$t("cart.checkout.form.subtotal")),1),e("div",ia,[c.value?(n(),l("span",ua,r(E(q.value)),1)):d("",!0),e("span",{class:Le(["total-value",{"discounted-subtotal":c.value}])},r(E(F.value)),3)])]),e("div",ca,[e("span",null,r(a.$t("cart.checkout.form.shipping")),1),e("span",da,[b(r(E(W.value))+" ",1),h.value==="gift"&&p.value?(n(),l("span",pa," ("+r(p.value.username)+") ",1)):s.value.city?(n(),l("span",va," ("+r(s.value.city)+") ",1)):d("",!0)])]),c.value?(n(),l("div",ma,[e("span",ha," üéâ Descuento "+r(c.value.code)+" (-"+r(c.value.discount_percentage)+"%) ",1),e("span",ga,"-"+r(E(te.value)),1)])):d("",!0),e("div",fa,[e("span",null,[b(r(a.$t("cart.checkout.form.tax"))+" ",1),o[35]||(o[35]=e("span",{class:"tax-included-badge"},"(Incluido)",-1))]),e("span",_a,r(E(ae.value)),1)])]),e("div",ya,[e("div",Pa,[e("span",Ca,r(a.$t("cart.checkout.form.total")),1),e("span",ba,r(E(se.value)),1)]),e("p",wa,r(a.$t("cart.checkout.form.taxIncluded",{tax:E(ae.value)})),1)])])])])]))}},Va=Be(Sa,[["__scopeId","data-v-d63c3b11"]]);export{Va as default};
