import{G as q,r as m,i as l}from"../index.js";const v="crushme_cart",p=q("cart",()=>{const r=m([]),s=m(!1),d=l(()=>r.value.reduce((e,a)=>e+a.quantity,0)),g=l(()=>r.value.reduce((e,a)=>e+a.quantity*a.price,0)),y=l(()=>r.value.length),_=l(()=>r.value.length===0),C=l(()=>r.value.length>0);function c(){try{const e=localStorage.getItem(v);e&&(r.value=JSON.parse(e))}catch{r.value=[]}}function u(){try{localStorage.setItem(v,JSON.stringify(r.value))}catch{}}function S(){return c(),{success:!0,data:{items:r.value}}}function h(e,a=1,t={}){s.value=!0;try{const o=JSON.stringify({variation_id:t.variation_id||null,color:t.color||null,size:t.size||null,attributes:t.attributes||null}),i=r.value.find(n=>{const O=JSON.stringify({variation_id:n.variation_id||null,color:n.color||null,size:n.size||null,attributes:n.attributes||null});return n.product_id===e&&O===o});if(i)i.quantity=i.quantity+a,i.name=t.name||i.name,i.price=parseFloat(t.price)||i.price,i.image=t.image||i.image,i.stock_status=t.stock_status||i.stock_status;else{const n={id:Date.now(),product_id:e,variation_id:t.variation_id||null,name:t.name||`Producto ${e}`,price:parseFloat(t.price)||0,image:t.image||null,stock_status:t.stock_status||"instock",color:t.color||null,size:t.size||null,attributes:t.attributes||null,quantity:a,added_at:new Date().toISOString()};console.log("ðŸ›’ [CartStore] Nuevo item agregado:",n),r.value.push(n)}return u(),{success:!0,data:{items:r.value}}}catch{return{success:!1,error:"Error al agregar al carrito"}}finally{s.value=!1}}function I(e,a){s.value=!0;try{const t=r.value.find(o=>o.id===e);return t&&(a<=0?f(e):(t.quantity=a,u())),{success:!0,data:{items:r.value}}}catch{return{success:!1,error:"Error al actualizar item"}}finally{s.value=!1}}function f(e){s.value=!0;try{const a=r.value.findIndex(t=>t.id===e);return a!==-1&&(r.value.splice(a,1),u()),{success:!0,data:{items:r.value}}}catch{return{success:!1,error:"Error al eliminar del carrito"}}finally{s.value=!1}}function b(){s.value=!0;try{return r.value=[],localStorage.removeItem(v),{success:!0,data:{items:[]}}}catch{return{success:!1,error:"Error al vaciar el carrito"}}finally{s.value=!1}}function z(e){return r.value.some(a=>a.product_id===e)}function E(e){const a=r.value.find(t=>t.product_id===e);return a?a.quantity:0}function k(e){return r.value.find(a=>a.id===e)}return c(),{items:r,isUpdating:s,totalItems:d,totalPrice:g,itemsCount:y,isEmpty:_,hasItems:C,initializeCart:S,addToCart:h,updateCartItem:I,removeFromCart:f,clearCart:b,isProductInCart:z,getProductQuantityInCart:E,getCartItemById:k,loadCart:c,saveCart:u}});export{p as u};
