import{u as q,s as O,r as p,l as Q,o as G,c as n,b as l,d as s,j as m,t as i,g as h,e as $,y as j,p as k,z as W,F as U,i as I,f as J,B as K,m as X,k as Z,q as ee}from"../index.js";import{u as te}from"./wishlistStore-BRMRVyY4.js";import{P as se}from"./ProductCard-BlrwzTCL.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as ie}from"./ClipboardDocumentListIcon-BdQzOBJL.js";import"./constants-DjCFsGER.js";import"./cartStore-CDfjOPb9.js";import"./authStore-DVIAn0uN.js";import"./profileStore-B4Vmm1K_.js";const re={class:"py-4 md:py-6"},le={class:"px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto"},ne={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6"},ae={class:"text-2xl md:text-3xl font-bold text-gray-900"},de={key:0,class:"text-xs md:text-sm text-gray-600 mt-1"},ue={class:"flex flex-wrap items-center gap-2 md:gap-3"},ce={class:"hidden sm:inline"},pe={class:"hidden sm:inline"},me=["disabled"],he={class:"mb-4 md:mb-6"},fe=["placeholder"],be=["disabled"],ve={key:0,class:"flex justify-center py-12"},ge={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},xe={class:"text-sm text-red-800"},ye={key:2,class:"space-y-3 md:space-y-4"},ke={class:"p-4 md:p-6"},_e={class:"flex flex-col md:flex-row md:items-start md:justify-between gap-3"},we={class:"flex-1"},$e={class:"text-base md:text-lg font-semibold text-gray-900 mb-1"},We={class:"text-xs md:text-sm text-gray-600 mb-2"},Ce={class:"text-xs text-gray-500"},Pe={key:0},Me={key:1},Be={class:"flex flex-wrap items-center gap-2"},Te=["onClick","disabled"],Se={class:"hidden sm:inline"},je=["onClick"],Ue=["onClick"],Ie={key:0,class:"px-4 md:px-6 pb-4 md:pb-6"},Le={key:0,class:"flex justify-center py-6 md:py-8"},Fe={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4"},He=["onClick","title"],Ve={key:2,class:"mt-2"},Ne={class:"text-xs text-gray-600 italic"},De={key:2,class:"text-sm text-gray-500 text-center py-8"},ze={key:3,class:"text-center py-12"},Ee={class:"mt-4 text-lg font-medium text-gray-900"},Re={class:"mt-2 text-sm text-gray-500"},Ae={class:"bg-white rounded-xl md:rounded-2xl p-5 md:p-6 max-w-md w-full"},Ye={class:"text-lg md:text-xl font-bold text-gray-900 mb-4"},qe={class:"space-y-4"},Oe={class:"block text-sm font-medium text-gray-700 mb-1"},Qe=["placeholder"],Ge={class:"block text-sm font-medium text-gray-700 mb-1"},Je=["placeholder"],Ke={class:"flex items-center"},Xe={for:"is_public",class:"ml-2 text-sm text-gray-700"},Ze={class:"flex gap-3 mt-6"},et=["disabled"],tt={__name:"ProfileWishlist",setup(st){const C=X(),d=te(),P=q(),{t:L}=O(),f=p(""),b=p([]),v=p(!1),x=p(null),_=p(null),g=p({}),c=p({name:"",description:"",is_public:!1}),u=p(null),y=p([]),M=Q(()=>u.value?y.value:d.wishlists),F=async e=>{var o;const t=b.value.indexOf(e);if(t>-1)b.value.splice(t,1);else if(b.value.push(e),!g.value[e]){_.value=e;try{let r;u.value?r=await d.fetchPublicWishlistByUsername(u.value.username,e):r=await d.fetchWishlist(e),r.success&&(console.log("📦 [WISHLIST DETAILS] Backend response:",{wishlist_id:e,total_items:r.data.total_items,currency:r.data.currency,items:r.data.items,first_item_example:(o=r.data.items)==null?void 0:o[0]}),g.value[e]=r.data)}catch(r){console.error("Error loading wishlist details:",r)}finally{_.value=null}}},B=e=>{const t=g.value[e];if(t&&t.items)return t.items;const o=d.wishlists.find(r=>r.id===e);return(o==null?void 0:o.items)||[]},H=e=>{var o,r,a,w,S;console.log("🔍 [WISHLIST ITEM] Raw data from backend:",{product_name:e.product_name,product_price:e.product_price,product_info_price:(o=e.product_info)==null?void 0:o.price,product_info_converted_price:(r=e.product_info)==null?void 0:r.converted_price,full_item:e});const t={...e.product_info,id:e.woocommerce_product_id,name:e.product_name,price:e.product_price,converted_price:e.product_price,images:((a=e.product_info)==null?void 0:a.images)||[{src:e.product_image}],stock_status:((w=e.product_info)==null?void 0:w.stock_status)||"instock"};return console.log("✅ [WISHLIST ITEM] Formatted for ProductCard:",{name:t.name,price:t.price,converted_price:t.converted_price,product_info_price:(S=e.product_info)==null?void 0:S.price}),t},V=e=>{C.push({name:`ProductDetail-${P.locale}`,params:{id:e}})},N=e=>{console.log("Product added to cart from wishlist:",e)},D=async()=>{(await d.createWishlist(c.value)).success&&(v.value=!1,c.value={name:"",description:"",is_public:!1})},z=async e=>{if(e.public_url)try{await navigator.clipboard.writeText(e.public_url),x.value=e.id,setTimeout(()=>x.value=null,2e3)}catch(t){console.error("Failed to copy:",t)}},E=e=>{var r;let t="";if(e.public_url)try{t=new URL(e.public_url).pathname}catch{t=e.public_url}else{const a=((r=u.value)==null?void 0:r.username)||e.user_username;if(!a){console.error("No username available for wishlist purchase");return}t=`/@${a}/${e.id}`}console.log("🎁 Navigating to wishlist checkout:",t);const o=window.location.origin+t;window.open(o,"_blank")},R=async(e,t)=>{if(!confirm(L("profile.wishlist.confirmRemove")))return;if((await d.removeWooCommerceProductFromWishlist(e,t)).success){const r=await d.fetchWishlist(e);r.success&&(g.value[e]=r.data)}},T=()=>{C.push({name:`Products-${P.locale}`})},A=async()=>{if(!f.value.trim())return;let e=f.value.trim();if(e.startsWith("@")&&(e=e.substring(1)),!e)return;const t=await d.fetchWishlistsByUsername(e);t.success&&(u.value=t.user,y.value=t.data,y.value=t.data.map(o=>({id:o.id,name:o.title||o.name,description:o.description,total_items:o.items_count||o.total_items||0,total_value:o.total_value||0,is_public:!0,public_url:o.public_url,shareable_path:o.shareable_path,created_at:o.created_at,user_username:e})))},Y=async()=>{f.value="",u.value=null,y.value=[],b.value=[],g.value={},await d.fetchWishlists()};return G(async()=>{await d.fetchWishlists()}),(e,t)=>(l(),n("div",re,[s("div",le,[s("div",ne,[s("div",null,[s("h1",ae,i(u.value?`@${u.value.username} ${e.$t("profile.wishlist.usersWishlists")}`:e.$t("profile.wishlist.myWishlists")),1),u.value?(l(),n("p",de,i(u.value.totalWishlists)+" "+i(u.value.totalWishlists!==1?e.$t("profile.wishlist.publicWishlistsPlural"):e.$t("profile.wishlist.publicWishlists")),1)):m("",!0)]),s("div",ue,[u.value?(l(),n("button",{key:0,onClick:Y,class:"flex items-center gap-2 px-3 md:px-4 py-2 border-2 border-gray-400 text-gray-700 bg-white rounded-full text-xs md:text-sm font-medium hover:bg-gray-100 transition-colors"},[t[8]||(t[8]=s("svg",{class:"w-3 h-3 md:w-4 md:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)),s("span",ce,i(e.$t("profile.wishlist.backToMyWishlists")),1)])):m("",!0),s("button",{onClick:T,class:"flex items-center gap-2 px-3 md:px-4 py-2 border-2 border-brand-pink-medium text-brand-pink-medium bg-white rounded-full text-xs md:text-sm font-medium hover:bg-brand-pink-medium hover:text-white transition-colors"},[t[9]||(t[9]=s("svg",{class:"w-3 h-3 md:w-4 md:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})],-1)),s("span",pe,i(e.$t("profile.wishlist.goToShop")),1)]),u.value?m("",!0):(l(),n("button",{key:1,onClick:t[0]||(t[0]=o=>v.value=!0),disabled:h(d).isUpdating,class:"flex items-center gap-2 px-3 md:px-4 py-2 border-2 border-brand-pink-medium text-brand-pink-medium bg-white rounded-full text-xs md:text-sm font-medium hover:bg-brand-pink-medium hover:text-white transition-colors disabled:opacity-50"},[t[10]||(t[10]=s("svg",{class:"w-3 h-3 md:w-4 md:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)),$(" "+i(e.$t("profile.wishlist.create")),1)],8,me))])]),s("div",he,[s("form",{onSubmit:j(A,["prevent"]),class:"relative max-w-md"},[t[11]||(t[11]=s("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[s("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),k(s("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>f.value=o),type:"text",placeholder:e.$t("profile.wishlist.searchPlaceholder"),class:"block w-full pl-10 pr-20 py-2.5 border border-gray-300 rounded-lg bg-white placeholder-gray-500 focus:ring-2 focus:ring-brand-pink-medium focus:border-transparent text-sm"},null,8,fe),[[W,f.value]]),s("button",{type:"submit",class:"absolute inset-y-0 right-0 flex items-center pr-3 text-brand-pink-medium hover:text-brand-pink-dark font-medium text-sm",disabled:!f.value.trim()},i(e.$t("profile.wishlist.search")),9,be)],32)]),h(d).isLoading?(l(),n("div",ve,[...t[12]||(t[12]=[s("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-pink-medium"},null,-1)])])):h(d).error?(l(),n("div",ge,[s("p",xe,i(h(d).error),1)])):M.value.length>0?(l(),n("div",ye,[(l(!0),n(U,null,I(M.value,o=>{var r;return l(),n("div",{key:o.id,class:"wishlist-card border-2 border-gray-900 rounded-xl md:rounded-2xl overflow-hidden"},[s("div",ke,[s("div",_e,[s("div",we,[s("h3",$e,i(o.name),1),s("p",We,i(o.description||e.$t("profile.wishlist.noDescription")),1),s("p",Ce,[$(i(o.total_items)+" "+i(e.$t("profile.wishlist.items"))+" · $"+i(((r=o.total_value)==null?void 0:r.toFixed(2))||"0.00")+" · ",1),o.is_public?(l(),n("span",Pe,i(e.$t("profile.wishlist.public")),1)):(l(),n("span",Me,i(e.$t("profile.wishlist.private")),1))])]),s("div",Be,[o.is_public?(l(),n("button",{key:0,onClick:a=>z(o),disabled:x.value===o.id,class:"flex items-center gap-1.5 md:gap-2 px-3 md:px-4 py-1.5 md:py-2 bg-brand-purple-light text-white rounded-full text-xs font-medium hover:opacity-90 transition-opacity whitespace-nowrap disabled:opacity-50"},[t[13]||(t[13]=s("svg",{class:"w-3 h-3 md:w-4 md:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})],-1)),s("span",Se,i(x.value===o.id?e.$t("profile.wishlist.copied"):e.$t("profile.wishlist.copyWishlistLink")),1)],8,Te)):m("",!0),s("button",{onClick:a=>E(o),class:"px-3 md:px-4 py-1.5 md:py-2 bg-brand-purple-light text-white rounded-full text-xs font-medium hover:opacity-90 transition-opacity whitespace-nowrap"},i(u.value?e.$t("profile.wishlist.buyWishlist"):e.$t("profile.wishlist.buyMyWishlist")),9,je),s("button",{onClick:a=>F(o.id),class:"p-2 hover:bg-gray-100 rounded-full transition-colors"},[(l(),n("svg",{class:Z(["w-5 h-5 text-gray-600 transition-transform",{"rotate-180":b.value.includes(o.id)}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[14]||(t[14]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,Ue)])])]),b.value.includes(o.id)?(l(),n("div",Ie,[_.value===o.id?(l(),n("div",Le,[...t[15]||(t[15]=[s("div",{class:"animate-spin rounded-full h-8 w-8 md:h-10 md:w-10 border-b-2 border-brand-pink-medium"},null,-1)])])):B(o.id).length>0?(l(),n("div",Fe,[(l(!0),n(U,null,I(B(o.id),a=>(l(),n("div",{key:a.id,class:"relative"},[u.value?m("",!0):(l(),n("button",{key:0,onClick:w=>R(o.id,a.woocommerce_product_id),class:"absolute top-2 right-2 z-10 bg-white hover:bg-red-600 text-gray-600 hover:text-white rounded-full p-1.5 shadow-md transition-colors",title:e.$t("profile.wishlist.removeFromWishlist")},[...t[16]||(t[16]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,He)),a.product_info?(l(),ee(se,{key:1,product:H(a),onNavigateToProduct:V,onAddToCart:N},null,8,["product"])):m("",!0),a.notes?(l(),n("div",Ve,[s("p",Ne,"💭 "+i(a.notes),1)])):m("",!0)]))),128))])):(l(),n("div",De,[t[17]||(t[17]=s("svg",{class:"w-16 h-16 mx-auto mb-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1)),s("p",null,i(e.$t("profile.wishlist.noProductsYet")),1),s("button",{onClick:T,class:"mt-3 text-brand-pink-medium hover:text-brand-pink-dark font-medium text-sm"},i(e.$t("profile.wishlist.browseProducts")),1)]))])):m("",!0)])}),128))])):(l(),n("div",ze,[J(h(ie),{class:"mx-auto h-16 w-16 text-gray-400"}),s("h3",Ee,i(e.$t("profile.wishlist.noWishlistsYet")),1),s("p",Re,i(e.$t("profile.wishlist.createFirstWishlist")),1),s("button",{onClick:t[2]||(t[2]=o=>v.value=!0),class:"mt-4 inline-flex items-center gap-2 px-4 py-2 border-2 border-brand-pink-medium text-brand-pink-medium bg-white rounded-full text-sm font-medium hover:bg-brand-pink-medium hover:text-white transition-colors"},[t[18]||(t[18]=s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)),$(" "+i(e.$t("profile.wishlist.createWishlist")),1)])]))]),v.value?(l(),n("div",{key:0,class:"fixed inset-0 bg-white/40 backdrop-blur-md flex items-center justify-center z-50 p-4",onClick:t[7]||(t[7]=j(o=>v.value=!1,["self"]))},[s("div",Ae,[s("h2",Ye,i(e.$t("profile.wishlist.createWishlistTitle")),1),s("div",qe,[s("div",null,[s("label",Oe,i(e.$t("profile.wishlist.name")),1),k(s("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>c.value.name=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-pink-medium focus:border-transparent",placeholder:e.$t("profile.wishlist.namePlaceholder")},null,8,Qe),[[W,c.value.name]])]),s("div",null,[s("label",Ge,i(e.$t("profile.wishlist.description")),1),k(s("textarea",{"onUpdate:modelValue":t[4]||(t[4]=o=>c.value.description=o),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-pink-medium focus:border-transparent",placeholder:e.$t("profile.wishlist.descriptionPlaceholder")},null,8,Je),[[W,c.value.description]])]),s("div",Ke,[k(s("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>c.value.is_public=o),type:"checkbox",id:"is_public",class:"h-4 w-4 text-brand-pink-medium focus:ring-brand-pink-medium border-gray-300 rounded"},null,512),[[K,c.value.is_public]]),s("label",Xe,i(e.$t("profile.wishlist.makePublic")),1)])]),s("div",Ze,[s("button",{onClick:t[6]||(t[6]=o=>v.value=!1),class:"flex-1 px-4 py-2 border-2 border-gray-300 text-gray-700 bg-white rounded-lg hover:bg-gray-100 transition-colors"},i(e.$t("profile.wishlist.cancel")),1),s("button",{onClick:D,disabled:!c.value.name||h(d).isUpdating,class:"flex-1 px-4 py-2 border-2 border-brand-pink-medium text-brand-pink-medium bg-white rounded-lg hover:bg-brand-pink-medium hover:text-white transition-colors disabled:opacity-50"},i(h(d).isUpdating?e.$t("profile.wishlist.creating"):e.$t("profile.wishlist.create")),9,et)])])])):m("",!0)]))}},pt=oe(tt,[["__scopeId","data-v-5ae6f0a0"]]);export{pt as default};
