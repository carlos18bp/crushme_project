import{N as De,u as Ie,r as m,l as k,E as Z,o as Ae,m as Ne,O as Oe,c as l,b as n,d as o,j as p,t as r,p as h,P as me,e as S,z as b,F as L,H as le,Q as Te,i as K,g as H,G as Le,k as Ve}from"./index.DcH1kEMW.js";import{u as Fe}from"./cartStore.Bv9yxI4b.js";import{u as Re}from"./authStore.DuW_1Au0.js";import{u as He}from"./crushStore.BIn0CIqC.js";import{u as qe}from"./paymentStore.DidcuC2O.js";import{u as ze}from"./productStore.-rT2qWWS.js";import{u as Ye}from"./useAlert.CfxTAlhR.js";import{C as Me,S as Ke}from"./state.DRCieogr.js";import{_ as Be}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./constants.DjCFsGER.js";const Ge={class:"checkout-view"},We={class:"checkout-container"},je={class:"shipping-section"},Je={class:"shipping-card"},Xe={class:"section-title"},Ze={class:"shipping-type"},xe={class:"radio-label"},Qe={class:"radio-label"},eo={class:"form-group"},oo={for:"email"},ao=["placeholder"],to={key:0,class:"gift-field-description"},so={class:"form-group"},ro={for:"fullname"},lo=["placeholder"],no={class:"form-group"},io={for:"country"},co={class:"form-group"},uo={for:"address1"},po=["placeholder"],vo={class:"form-group"},mo={for:"address2"},ho=["placeholder"],fo={class:"form-group"},go={for:"city"},_o=["placeholder"],yo={key:0,class:"city-shipping-info"},Po={class:"form-row"},Co={class:"form-group"},ko={for:"state"},bo={value:""},wo=["value"],So={class:"form-group"},$o={for:"zipcode"},Eo=["placeholder"],Uo={class:"form-group"},Do={for:"phone"},Io={class:"phone-input"},Ao=["value"],No=["placeholder"],Oo={class:"form-group"},To={for:"additional"},Lo=["placeholder"],Vo={class:"form-group"},Fo={for:"username"},Ro={class:"username-search-container"},Ho=["placeholder"],qo={key:0,class:"username-search-results"},zo=["onMousedown"],Yo=["src","alt"],Mo={class:"search-user-info"},Ko={class:"search-username"},Bo={key:0,class:"search-crush-label"},Go={class:"gift-field-description"},Wo={class:"form-group"},jo={for:"note"},Jo=["placeholder"],Xo={class:"form-group payment-button-section"},Zo=["disabled"],xo={key:0,class:"payment-error"},Qo={key:2,id:"paypal-section",class:"paypal-section"},ea={class:"paypal-title"},oa={class:"summary-section"},aa={class:"summary-card"},ta={class:"section-title"},sa={key:0,class:"loading-state"},ra={key:1,class:"products-list"},la={class:"product-image"},na=["src","alt"],ia={class:"product-details"},ca={class:"product-name"},ua={key:0,class:"product-meta"},da={key:1,class:"product-meta"},pa={key:2,class:"product-meta"},va={key:3,class:"product-meta variation-id"},ma={class:"product-quantity"},ha={class:"product-price"},fa={class:"discount-section"},ga={class:"discount-title"},_a={key:0,class:"discount-input"},ya=["placeholder","disabled"],Pa=["disabled"],Ca={key:1,class:"discount-applied"},ka={class:"discount-applied-content"},ba={class:"discount-code-badge"},wa={class:"discount-percentage"},Sa={key:2,class:"discount-error"},$a={class:"totals-section"},Ea={class:"total-row"},Ua={class:"subtotal-values"},Da={key:0,class:"original-subtotal"},Ia={class:"total-row"},Aa={class:"total-value"},Na={key:0,class:"shipping-city-note"},Oa={key:1,class:"shipping-city-note"},Ta={key:0,class:"total-row discount-row"},La={class:"discount-label"},Va={class:"total-value discount-value"},Fa={class:"total-row tax-row"},Ra={class:"tax-included-badge"},Ha={class:"total-value tax-included-value"},qa={class:"final-total"},za={class:"total-row"},Ya={class:"total-label"},Ma={class:"total-amount"},Ka={class:"tax-note"},he=48500,Ba={__name:"CheckoutView",setup(Ga){const x=Ne(),_=De(),$=e=>_.formatPrice(e),q=e=>_.currentCurrency==="USD"?Math.round(e/4e3*100)/100:e,E=Fe(),V=Re(),y=He(),B=Ie(),N=qe(),fe=ze(),{showSuccess:ne,showError:C,showLoading:ie,closeAlert:G}=Ye(),ge=Me.getAllCountries().map(e=>({...e,flag:e.flag||"ðŸ³ï¸"})),_e=[{code:"CO",dial_code:"+57",flag:"ðŸ‡¨ðŸ‡´",name:"Colombia"}],v=m("me"),s=m({email:"",fullName:"",country:"CO",address1:"",address2:"",city:"",state:"",zipCode:"",phoneCode:"+57",phone:"",additionalDetails:"",username:"",note:""}),D=m(""),d=m(null),O=m(""),z=m(!1),w=m(""),Q=m(!1),ee=m(!1),U=m(null),ce=m(!1),I=m(""),T=m(!1),u=m(null);let A=null;const W=m(null),oe=m(null),ye=k(()=>Ke.getStatesOfCountry("CO")),Pe=k(()=>E.items),ue=k(()=>V.isLoggedIn&&V.username),Ce=k(()=>u.value&&u.value.username?B.locale==="es"?`Nota para @${u.value.username}`:`Note for @${u.value.username}`:B.locale==="es"?"Nota para el destinatario":"Note for recipient"),ke=async e=>{if(!e||!e.trim()){y.clearSearch();return}try{await y.searchUsers(e.trim(),5)}catch(t){console.error("Error searching users:",t)}},de=e=>{console.log("ðŸ‘¤ [SELECT USER] Usuario seleccionado:",e),u.value=e,T.value=!1,y.clearSearch(),A&&(clearTimeout(A),A=null),s.value.username=`@${e.username}`,I.value=`@${e.username}`,console.log("ðŸ’° [SELECT USER] Costo de envÃ­o del usuario:",e.shipping_cost)};Z(I,e=>{if(s.value.username=e,A&&clearTimeout(A),!e.trim()){y.clearSearch(),T.value=!1,u.value=null;return}if(u.value&&e===`@${u.value.username}`){console.log("â­ï¸ [WATCH] Usuario ya seleccionado, no buscar de nuevo");return}A=setTimeout(async()=>{await ke(e),T.value=y.searchResults.length>0},300)}),Z(v,e=>{e!=="gift"&&(I.value="",T.value=!1,u.value=null,y.clearSearch())}),Z(()=>s.value.username,e=>{v.value==="gift"&&e!==I.value&&(I.value=e)});const be=async()=>{ce.value=!0;try{console.log(`ðŸ“¦ [DROPSHIPPING] Consultando producto ${he}...`);const e=await fe.fetchWooProduct(he);e.success&&e.data?(U.value=e.data,console.log("âœ… [DROPSHIPPING] Producto cargado:",{id:e.data.id,name:e.data.name,price:e.data.price})):console.error("âŒ [DROPSHIPPING] Error al cargar producto:",e.error)}catch(e){console.error("âŒ [DROPSHIPPING] Error inesperado:",e)}finally{ce.value=!1}},Y=k(()=>E.totalPrice),ae=k(()=>{if(v.value==="me"){const e=!!(s.value.email&&s.value.fullName&&s.value.address1&&s.value.city&&s.value.state&&s.value.zipCode&&s.value.phone);return e||console.log("ðŸ” [VALIDATION] Campos faltantes:",{email:!!s.value.email,fullName:!!s.value.fullName,address1:!!s.value.address1,city:!!s.value.city,state:!!s.value.state,zipCode:!!s.value.zipCode,phone:!!s.value.phone}),e}return v.value==="gift"?!!(s.value.email&&s.value.username):!1}),we=async()=>{var e,t,a,i,f,c,g;w.value="";try{if(console.log("ðŸ“¦ [CHECKOUT] Preparando datos para pago..."),!ae.value){w.value="Por favor completa todos los campos obligatorios",await C("Completa todos los campos obligatorios antes de continuar.","âš ï¸ Campos Incompletos");return}if(!E.items||E.items.length===0){w.value="El carrito estÃ¡ vacÃ­o",await C("Tu carrito estÃ¡ vacÃ­o.","ðŸ›’ Carrito VacÃ­o");return}const X=ge.find(P=>P.isoCode===s.value.country),ve=X?X.name:s.value.country,re=E.items.map(P=>({woocommerce_product_id:P.product_id||P.id,woocommerce_variation_id:P.variation_id||null,product_name:P.name,quantity:P.quantity,unit_price:_.currentCurrency==="USD"?parseFloat(parseFloat(P.price).toFixed(2)):parseFloat(P.price),attributes:P.attributes||null}));U.value&&(re.push({woocommerce_product_id:U.value.id,woocommerce_variation_id:null,product_name:U.value.name,quantity:1,unit_price:_.currentCurrency==="USD"?parseFloat(parseFloat(U.value.price).toFixed(2)):parseFloat(U.value.price),attributes:null}),console.log("ðŸ“¦ [DROPSHIPPING] Producto agregado a items"));let R;v.value==="gift"?(R={items:re,customer_email:s.value.email,customer_name:ue.value?`${((e=V.user)==null?void 0:e.first_name)||""} ${((t=V.user)==null?void 0:t.last_name)||""}`.trim()||V.username:s.value.email,receiver_username:s.value.username.replace("@",""),gift_message:s.value.note||"",is_gift:!0,shipping:_.currentCurrency==="USD"?parseFloat(F.value.toFixed(2)):F.value,total:_.currentCurrency==="USD"?parseFloat(M.value.toFixed(2)):M.value,is_from_wishlist:!!W.value,wishlist_id:W.value||null,wishlist_name:oe.value||null,shipping_address:((a=u.value)==null?void 0:a.address)||"DirecciÃ³n del destinatario",shipping_city:((i=u.value)==null?void 0:i.city)||"Ciudad",shipping_state:((f=u.value)==null?void 0:f.state)||"Departamento",shipping_postal_code:((c=u.value)==null?void 0:c.postal_code)||"00000",shipping_country:ve,phone_number:((g=u.value)==null?void 0:g.phone)||"+57 300 0000000"},ue.value&&(R.sender_username=V.username)):R={items:re,customer_email:s.value.email,customer_name:s.value.fullName,shipping_address:s.value.address1,shipping_address_line_2:s.value.address2||"",shipping_city:s.value.city,shipping_state:s.value.state,shipping_postal_code:s.value.zipCode,shipping_country:ve,phone_number:`${s.value.phoneCode} ${s.value.phone}`,notes:s.value.additionalDetails||"",shipping:_.currentCurrency==="USD"?parseFloat(F.value.toFixed(2)):F.value,total:_.currentCurrency==="USD"?parseFloat(M.value.toFixed(2)):M.value},console.log("ðŸ“¤ [CHECKOUT] Datos de orden preparados:",R),_.currentCurrency==="COP"?await Se(R):(sessionStorage.setItem("checkout_order_data",JSON.stringify(R)),Q.value=!0,setTimeout(()=>{const P=document.getElementById("paypal-section");P&&P.scrollIntoView({behavior:"smooth",block:"center"})},100))}catch(X){console.error("âŒ [CHECKOUT] Error al preparar datos:",X),w.value="Error al preparar la orden",await C("Error al preparar la orden.","âŒ Error")}},Se=async e=>{try{ie("Creando transacciÃ³n...","ðŸ’³ Wompi"),console.log("ðŸ’³ [WOMPI] Iniciando pago...",e);const t=await N.createWompiTransaction(e);if(G(),!t.success){w.value=t.error||"Error al crear transacciÃ³n en Wompi",await C(w.value,"âŒ Error en Wompi");return}console.log("âœ… [WOMPI] TransacciÃ³n creada:",t.data),localStorage.setItem("wompi_transaction_id",t.data.transaction_id),localStorage.setItem("wompi_order_data",JSON.stringify(e)),window.location.href=t.data.payment_url}catch(t){G(),console.error("âŒ [WOMPI] Error inesperado:",t),w.value="Error al procesar el pago con Wompi",await C(w.value,"âŒ Error")}},$e=async()=>new Promise(async(e,t)=>{if(window.paypal){console.log("ðŸ’³ [PAYPAL] SDK ya estÃ¡ cargado"),ee.value=!0,e();return}const a=document.querySelector('script[src*="paypal.com/sdk/js"]');if(a){a.addEventListener("load",()=>{console.log("ðŸ’³ [PAYPAL] SDK cargado desde script existente"),ee.value=!0,e()});return}console.log("ðŸ’³ [PAYPAL] Obteniendo configuraciÃ³n...");const i=await N.fetchPayPalConfig();if(!i.success){console.error("âŒ [PAYPAL] Error al obtener configuraciÃ³n"),t(new Error(i.error));return}const f=i.data;console.log("ðŸ’³ [PAYPAL] Cargando SDK...");const c=document.createElement("script");c.src=`https://www.paypal.com/sdk/js?client-id=${f.client_id}&buyer-country=US&currency=${f.currency}&components=buttons&enable-funding=venmo,paylater,card`,c.setAttribute("data-sdk-integration-source","developer-studio"),c.onload=()=>{console.log("âœ… [PAYPAL] SDK cargado exitosamente"),ee.value=!0,e()},c.onerror=g=>{console.error("âŒ [PAYPAL] Error al cargar SDK:",g),t(g)},document.head.appendChild(c)}),Ee=()=>{if(!window.paypal){console.error("âŒ [PAYPAL] SDK no estÃ¡ disponible");return}const e=document.getElementById("paypal-button-container");if(!e){console.error("âŒ [PAYPAL] Contenedor no encontrado");return}e.innerHTML="";const t=sessionStorage.getItem("checkout_order_data");if(!t){console.error("âŒ [PAYPAL] No hay datos de orden");return}const a=JSON.parse(t);window.paypal.Buttons({style:{layout:"vertical",color:"gold",shape:"rect",label:"paypal"},createOrder:async(i,f)=>{console.log("ðŸ’³ [PAYPAL] Creando orden...");try{if(a.is_gift){const g=await N.sendGift(a);if(!g.success)throw new Error(g.error);return g.paypal_order_id}const c=await N.createPayPalOrder(a);if(!c.success)throw new Error(c.error);return c.paypal_order_id}catch(c){throw console.error("âŒ [PAYPAL] Error al crear orden:",c),await C(c.message||"Error al crear orden","âŒ Error"),c}},onApprove:async(i,f)=>{console.log("âœ… [PAYPAL] Pago aprobado");try{ie("Procesando tu pago...","ðŸ’³ Procesando");const c={paypal_order_id:i.orderID,...a},g=await N.capturePayPalOrder(i.orderID,c);if(G(),!g.success)throw new Error(g.error);console.log("âœ… [PAYPAL] Pago procesado exitosamente"),await ne(`Tu orden ha sido creada exitosamente.

ðŸ“‹ Orden: ${g.order.order_number}
ðŸ’° Total: $${g.order.total}

RecibirÃ¡s un email de confirmaciÃ³n pronto.`,"ðŸŽ‰ Â¡Pago Exitoso!",{timer:8e3}),sessionStorage.removeItem("checkout_order_data"),E.clearCart(),N.clearPaymentState(),setTimeout(()=>{x.push({name:`Home-${B.locale}`})},1e3)}catch(c){console.error("âŒ [PAYPAL] Error al capturar pago:",c),G(),await C(c.message||"Error al procesar el pago","âŒ Error")}},onCancel:i=>{console.log("âš ï¸ [PAYPAL] Pago cancelado"),C("Has cancelado el proceso de pago.","âš ï¸ Pago Cancelado",{timer:5e3})},onError:i=>{console.error("âŒ [PAYPAL] Error:",i),C("Hubo un error con PayPal. Por favor intenta de nuevo.","âŒ Error en PayPal")}}).render("#paypal-button-container")},pe=async()=>{var e,t;if(!D.value||!D.value.trim()){O.value="Por favor ingresa un cÃ³digo de descuento";return}z.value=!0,O.value="";try{console.log("ðŸŽŸï¸ [DISCOUNT] Validando cÃ³digo:",D.value);const a=await N.validateDiscountCode(D.value.trim().toUpperCase());console.log("ðŸŽŸï¸ [DISCOUNT] Respuesta:",a),a.success&&a.data.exists&&a.data.is_valid?(d.value={code:a.data.code,discount_percentage:parseFloat(a.data.discount_percentage)},await ne(`Â¡CÃ³digo aplicado! Descuento del ${a.data.discount_percentage}%`,"ðŸŽ‰ Descuento Aplicado"),console.log("âœ… [DISCOUNT] Descuento aplicado:",d.value)):(d.value=null,O.value=((e=a.data)==null?void 0:e.message)||a.error||"CÃ³digo de descuento no vÃ¡lido",await C(((t=a.data)==null?void 0:t.message)||a.error||"El cÃ³digo ingresado no es vÃ¡lido o ha expirado","âŒ CÃ³digo InvÃ¡lido"))}catch(a){console.error("âŒ [DISCOUNT] Error al validar:",a),d.value=null,O.value="Error al validar el cÃ³digo",await C("Hubo un error al validar el cÃ³digo. Por favor intenta de nuevo.","âŒ Error")}finally{z.value=!1}},Ue=()=>{d.value=null,D.value="",O.value="",console.log("ðŸ—‘ï¸ [DISCOUNT] Descuento removido")},F=k(()=>{if(v.value==="gift"&&u.value&&u.value.shipping_cost){const t=parseFloat(u.value.shipping_cost),a=q(t);return console.log(`ðŸ“¦ [SHIPPING] Costo del usuario destinatario: ${t} COP â†’ ${a} ${_.currentCurrency}`),a}const e=(s.value.city||"").toLowerCase().trim();if(!e)return q(15e3);switch(e){case"medellÃ­n":case"medellin":return q(10500);case"san andrÃ©s isla":case"san andres isla":case"san andrÃ©s":case"san andres":case"santa catalina":case"providencia":return q(45e3);default:return q(15e3)}}),j=k(()=>{let e=F.value;if(U.value&&U.value.price){const t=parseFloat(U.value.price);e+=t,console.log(`ðŸ“¦ [DROPSHIPPING] Shipping mostrado: ${F.value} + ${t} = ${e}`)}return e}),te=k(()=>J.value*(.19/1.19)),se=k(()=>{if(!d.value)return 0;const e=Y.value*d.value.discount_percentage/100;return console.log("ðŸŽŸï¸ [DISCOUNT] Monto calculado:",{subtotal:Y.value,percentage:d.value.discount_percentage,discount:e}),e}),J=k(()=>Y.value-se.value),M=k(()=>{const e=J.value+j.value;return console.log("ðŸ’° [TOTAL] CÃ¡lculo:",{subtotal:Y.value,discount:se.value,subtotal_after_discount:J.value,shipping:j.value,tax_included:te.value,total:e}),e});return Ae(async()=>{if(E.loadCart(),E.isEmpty){x.push({name:`Cart-${B.locale}`});return}const e=x.currentRoute.value;if(e.query.giftMode==="true"){if(v.value="gift",e.query.username){const t=e.query.username,a=t.startsWith("@")?t:`@${t}`;s.value.username=a,I.value=a;try{const i=t.replace("@","").trim();if(console.log("ðŸ” [CHECKOUT] Buscando usuario automÃ¡ticamente:",i),await y.searchUsers(i,5),y.searchResults.length>0){const f=y.searchResults.find(c=>c.username.toLowerCase()===i.toLowerCase());f?(console.log("âœ… [CHECKOUT] Usuario encontrado automÃ¡ticamente:",f),de(f)):console.warn("âš ï¸ [CHECKOUT] No se encontrÃ³ coincidencia exacta para:",i)}else console.warn("âš ï¸ [CHECKOUT] No se encontraron resultados para:",i)}catch(i){console.error("âŒ [CHECKOUT] Error al buscar usuario automÃ¡ticamente:",i)}}e.query.wishlistId&&(W.value=parseInt(e.query.wishlistId),oe.value=e.query.wishlistName||null,console.log("ðŸŽ [WISHLIST] Compra desde wishlist:",{id:W.value,name:oe.value}))}await be()}),Z(Q,async e=>{if(e&&_.currentCurrency==="USD")try{await $e(),setTimeout(()=>{Ee()},100)}catch(t){console.error("âŒ [PAYPAL] Error al inicializar:",t),await C("No se pudo cargar PayPal.","âŒ Error")}}),Oe(()=>{A&&clearTimeout(A),u.value=null,y.clearSearch()}),(e,t)=>(n(),l("div",Ge,[o("div",We,[o("div",je,[o("div",Je,[o("h2",Xe,r(e.$t("cart.checkout.shippingInformation")),1),o("div",Ze,[o("label",xe,[h(o("input",{type:"radio",name:"shipping-type",value:"me","onUpdate:modelValue":t[0]||(t[0]=a=>v.value=a),checked:""},null,512),[[me,v.value]]),o("span",null,r(e.$t("cart.checkout.shippingType.forMe")),1)]),o("label",Qe,[h(o("input",{type:"radio",name:"shipping-type",value:"gift","onUpdate:modelValue":t[1]||(t[1]=a=>v.value=a)},null,512),[[me,v.value]]),o("span",null,r(e.$t("cart.checkout.shippingType.forGift")),1)])]),o("div",eo,[o("label",oo,[S(r(v.value==="gift"?e.$t("cart.checkout.form.emailGift"):e.$t("cart.checkout.form.email"))+" ",1),t[18]||(t[18]=o("span",{class:"text-red-500"},"*",-1))]),h(o("input",{type:"email",id:"email","onUpdate:modelValue":t[2]||(t[2]=a=>s.value.email=a),placeholder:v.value==="gift"?e.$t("cart.checkout.form.placeholders.emailGift"):e.$t("cart.checkout.form.placeholders.email"),class:"form-input",required:""},null,8,ao),[[b,s.value.email]]),v.value==="gift"?(n(),l("p",to,r(e.$t("cart.checkout.form.help.emailGift")),1)):p("",!0)]),v.value==="me"?(n(),l(L,{key:0},[o("div",so,[o("label",ro,[S(r(e.$t("cart.checkout.form.fullName"))+" ",1),t[19]||(t[19]=o("span",{class:"text-red-500"},"*",-1))]),h(o("input",{type:"text",id:"fullname","onUpdate:modelValue":t[3]||(t[3]=a=>s.value.fullName=a),placeholder:e.$t("cart.checkout.form.placeholders.fullName"),class:"form-input",required:""},null,8,lo),[[b,s.value.fullName]])]),o("div",no,[o("label",io,r(e.$t("cart.checkout.form.country")),1),h(o("select",{id:"country","onUpdate:modelValue":t[4]||(t[4]=a=>s.value.country=a),class:"form-input form-select",disabled:""},[...t[20]||(t[20]=[o("option",{value:"CO"},"ðŸ‡¨ðŸ‡´ Colombia",-1)])],512),[[le,s.value.country]])]),o("div",co,[o("label",uo,[S(r(e.$t("cart.checkout.form.address1"))+" ",1),t[21]||(t[21]=o("span",{class:"text-red-500"},"*",-1))]),h(o("input",{type:"text",id:"address1","onUpdate:modelValue":t[5]||(t[5]=a=>s.value.address1=a),placeholder:e.$t("cart.checkout.form.placeholders.address1"),class:"form-input",required:""},null,8,po),[[b,s.value.address1]])]),o("div",vo,[o("label",mo,r(e.$t("cart.checkout.form.address2")),1),h(o("input",{type:"text",id:"address2","onUpdate:modelValue":t[6]||(t[6]=a=>s.value.address2=a),placeholder:e.$t("cart.checkout.form.placeholders.address2"),class:"form-input"},null,8,ho),[[b,s.value.address2]])]),o("div",fo,[o("label",go,[S(r(e.$t("cart.checkout.form.city"))+" ",1),t[22]||(t[22]=o("span",{class:"text-red-500"},"*",-1))]),h(o("input",{type:"text",id:"city","onUpdate:modelValue":t[7]||(t[7]=a=>s.value.city=a),placeholder:e.$t("cart.checkout.form.placeholders.city"),class:"form-input",required:"",list:"colombia-cities"},null,8,_o),[[b,s.value.city]]),t[23]||(t[23]=Te('<datalist id="colombia-cities" data-v-31c9340e><option value="MedellÃ­n" data-v-31c9340e></option><option value="BogotÃ¡" data-v-31c9340e></option><option value="Cali" data-v-31c9340e></option><option value="Barranquilla" data-v-31c9340e></option><option value="Cartagena" data-v-31c9340e></option><option value="San AndrÃ©s Isla" data-v-31c9340e></option><option value="Santa Catalina" data-v-31c9340e></option><option value="Providencia" data-v-31c9340e></option><option value="Bucaramanga" data-v-31c9340e></option><option value="Pereira" data-v-31c9340e></option><option value="Manizales" data-v-31c9340e></option><option value="IbaguÃ©" data-v-31c9340e></option><option value="Villavicencio" data-v-31c9340e></option><option value="Pasto" data-v-31c9340e></option><option value="Neiva" data-v-31c9340e></option></datalist>',1)),s.value.city?(n(),l("p",yo,[o("span",null,r(e.$t("cart.checkout.form.shippingCost",{cost:$(j.value)})),1)])):p("",!0)]),o("div",Po,[o("div",Co,[o("label",ko,[S(r(e.$t("cart.checkout.form.state"))+" ",1),t[24]||(t[24]=o("span",{class:"text-red-500"},"*",-1))]),h(o("select",{id:"state","onUpdate:modelValue":t[8]||(t[8]=a=>s.value.state=a),class:"form-input form-select",required:""},[o("option",bo,r(e.$t("cart.checkout.form.placeholders.selectState")),1),(n(!0),l(L,null,K(ye.value,a=>(n(),l("option",{key:a.isoCode,value:a.name},r(a.name),9,wo))),128))],512),[[le,s.value.state]])]),o("div",So,[o("label",$o,[S(r(e.$t("cart.checkout.form.zipCode"))+" ",1),t[25]||(t[25]=o("span",{class:"text-red-500"},"*",-1))]),h(o("input",{type:"text",id:"zipcode","onUpdate:modelValue":t[9]||(t[9]=a=>s.value.zipCode=a),placeholder:e.$t("cart.checkout.form.placeholders.zipCode"),class:"form-input",required:""},null,8,Eo),[[b,s.value.zipCode]])])]),o("div",Uo,[o("label",Do,[S(r(e.$t("cart.checkout.form.phone"))+" ",1),t[26]||(t[26]=o("span",{class:"text-red-500"},"*",-1))]),o("div",Io,[h(o("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>s.value.phoneCode=a),class:"phone-code",disabled:""},[(n(),l(L,null,K(_e,a=>o("option",{key:a.code,value:a.dial_code},r(a.flag)+" "+r(a.dial_code),9,Ao)),64))],512),[[le,s.value.phoneCode]]),h(o("input",{type:"tel",id:"phone","onUpdate:modelValue":t[11]||(t[11]=a=>s.value.phone=a),placeholder:e.$t("cart.checkout.form.placeholders.phone"),class:"form-input phone-number",required:""},null,8,No),[[b,s.value.phone]])])]),o("div",Oo,[o("label",To,r(e.$t("cart.checkout.form.additionalDetails")),1),h(o("textarea",{id:"additional","onUpdate:modelValue":t[12]||(t[12]=a=>s.value.additionalDetails=a),placeholder:e.$t("cart.checkout.form.placeholders.additionalDetails"),class:"form-textarea",rows:"3"},null,8,Lo),[[b,s.value.additionalDetails]])])],64)):p("",!0),v.value==="gift"?(n(),l(L,{key:1},[o("div",Vo,[o("label",Fo,[S(r(e.$t("cart.checkout.form.recipientUsername"))+" ",1),t[27]||(t[27]=o("span",{class:"text-red-500"},"*",-1))]),o("div",Ro,[h(o("input",{type:"text",id:"username","onUpdate:modelValue":t[13]||(t[13]=a=>I.value=a),placeholder:e.$t("cart.checkout.form.placeholders.searchUser"),class:"form-input username-search-input",autocomplete:"off",onFocus:t[14]||(t[14]=a=>T.value=H(y).searchResults.length>0),onBlur:t[15]||(t[15]=()=>e.setTimeout(()=>T.value=!1,200))},null,40,Ho),[[b,I.value]]),T.value&&H(y).searchResults.length>0?(n(),l("div",qo,[(n(!0),l(L,null,K(H(y).searchResults,a=>(n(),l("div",{key:a.id,class:"username-search-item",onMousedown:i=>de(a)},[o("img",{src:a.profile_picture||"https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=40",alt:a.username,class:"search-avatar"},null,8,Yo),o("div",Mo,[o("span",Ko,"@"+r(a.username),1),a.is_crush?(n(),l("span",Bo,"Crush")):p("",!0)])],40,zo))),128))])):p("",!0)]),o("p",Go,r(e.$t("cart.checkout.form.help.recipientUsername")),1)]),o("div",Wo,[o("label",jo,r(Ce.value),1),h(o("textarea",{id:"note","onUpdate:modelValue":t[16]||(t[16]=a=>s.value.note=a),placeholder:e.$t("cart.checkout.form.placeholders.giftNote"),class:"form-textarea",rows:"3"},null,8,Jo),[[b,s.value.note]])])],64)):p("",!0),o("div",Xo,[o("button",{onClick:we,disabled:!ae.value,class:"continue-payment-btn"},r(ae.value?H(_).currentCurrency==="COP"?e.$t("cart.checkout.form.buttons.payWithWompi"):e.$t("cart.checkout.form.buttons.continueToPay"):e.$t("cart.checkout.form.buttons.completeRequired")),9,Zo),w.value?(n(),l("p",xo,r(w.value),1)):p("",!0)]),Q.value&&H(_).currentCurrency==="USD"?(n(),l("div",Qo,[o("h3",ea,r(e.$t("cart.checkout.form.paypal.title")),1),t[28]||(t[28]=o("div",{id:"paypal-button-container"},null,-1))])):p("",!0)])]),o("div",oa,[o("div",aa,[o("h2",ta,r(e.$t("cart.checkout.form.orderSummary")),1),H(E).isUpdating?(n(),l("div",sa,[o("p",null,r(e.$t("cart.checkout.form.loadingProducts")),1)])):(n(),l("div",ra,[(n(!0),l(L,null,K(Pe.value,a=>(n(),l("div",{key:a.id,class:"product-item"},[o("div",la,[o("img",{src:a.image||"https://images.unsplash.com/photo-1560769629-975ec94e6a86?w=200",alt:a.name||"Product"},null,8,na)]),o("div",ia,[o("h4",ca,r(a.name||"Product"),1),a.color?(n(),l("p",ua,r(e.$t("cart.checkout.form.color"))+": "+r(a.color),1)):p("",!0),a.size?(n(),l("p",da,r(e.$t("cart.checkout.form.size"))+": "+r(a.size),1)):p("",!0),a.attributes&&Object.keys(a.attributes).length>0?(n(),l("p",pa,[(n(!0),l(L,null,K(a.attributes,(i,f)=>(n(),l("span",{key:f},r(f)+": "+r(i),1))),128))])):p("",!0),a.variation_id?(n(),l("p",va,r(e.$t("cart.checkout.form.variation"))+": #"+r(a.variation_id),1)):p("",!0)]),o("div",ma,[o("span",null,r(a.quantity),1)]),o("div",ha,r($(a.price*a.quantity)),1)]))),128))])),o("div",fa,[o("h3",ga,r(e.$t("cart.checkout.form.discountCode")),1),d.value?p("",!0):(n(),l("div",_a,[h(o("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=a=>D.value=a),placeholder:e.$t("cart.checkout.form.placeholders.discountCode"),class:"form-input",disabled:z.value,onKeyup:Le(pe,["enter"])},null,40,ya),[[b,D.value]]),o("button",{onClick:pe,disabled:z.value||!D.value.trim(),class:"validate-btn"},r(z.value?e.$t("cart.checkout.form.buttons.validating"):e.$t("cart.checkout.form.buttons.validate")),9,Pa)])),d.value?(n(),l("div",Ca,[o("div",ka,[o("span",ba,r(d.value.code),1),o("span",wa,"-"+r(d.value.discount_percentage)+"%",1)]),o("button",{onClick:Ue,class:"remove-discount-btn",title:"Remover descuento"}," âœ• ")])):p("",!0),O.value&&!d.value?(n(),l("p",Sa,r(O.value),1)):p("",!0)]),o("div",$a,[o("div",Ea,[o("span",null,r(e.$t("cart.checkout.form.subtotal")),1),o("div",Ua,[d.value?(n(),l("span",Da,r($(Y.value)),1)):p("",!0),o("span",{class:Ve(["total-value",{"discounted-subtotal":d.value}])},r($(J.value)),3)])]),o("div",Ia,[o("span",null,r(e.$t("cart.checkout.form.shipping")),1),o("span",Aa,[S(r($(j.value))+" ",1),v.value==="gift"&&u.value?(n(),l("span",Na," ("+r(u.value.username)+") ",1)):s.value.city?(n(),l("span",Oa," ("+r(s.value.city)+") ",1)):p("",!0)])]),d.value?(n(),l("div",Ta,[o("span",La,r(e.$t("cart.checkout.form.discountApplied",{code:d.value.code,percentage:d.value.discount_percentage})),1),o("span",Va,"-"+r($(se.value)),1)])):p("",!0),o("div",Fa,[o("span",null,[S(r(e.$t("cart.checkout.form.tax"))+" ",1),o("span",Ra,r(e.$t("cart.checkout.form.taxIncludedBadge")),1)]),o("span",Ha,r($(te.value)),1)])]),o("div",qa,[o("div",za,[o("span",Ya,r(e.$t("cart.checkout.form.total")),1),o("span",Ma,r($(M.value)),1)]),o("p",Ka,r(e.$t("cart.checkout.form.taxIncluded",{tax:$(te.value)})),1)])])])])]))}},tt=Be(Ba,[["__scopeId","data-v-31c9340e"]]);export{tt as default};
