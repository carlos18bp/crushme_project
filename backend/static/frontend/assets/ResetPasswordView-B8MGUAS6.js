import{p as V,u as z,r as c,B as q,q as N,i as R,c as l,o as i,a as s,d as f,t as d,s as L,h as F,v as k,y as P,l as T,n as D,b as _,w as I,e as U,f as E,k as H}from"../index.js";import{u as W}from"./authStore-tY-7-Xic.js";import{L as Z}from"./LanguageSelector-vuDdTwQ1.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-DjCFsGER.js";const J={class:"reset-password-view"},K={class:"reset-password-container"},O={class:"reset-password-card"},Q={class:"welcome-section"},X={class:"welcome-title"},Y={class:"welcome-subtitle"},ss={class:"input-group"},es={class:"password-input-container"},ts=["type","placeholder"],os={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},rs={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ns={class:"input-group"},as={class:"password-input-container"},ls=["type","placeholder"],is={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ds={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},cs={key:0,class:"password-strength"},ws={class:"strength-label"},us={class:"strength-bar"},ps=["disabled"],hs={key:0},ms={key:1,class:"loading-spinner"},gs={class:"back-link"},vs={__name:"ResetPasswordView",setup(fs){const y=H(),g=q(),{t:r}=V(),m=z(),b=W(),v=c(g.query.email||""),C=c(g.query.reset_code||""),o=N({newPassword:"",confirmPassword:""}),w=c(!1),u=c(!1),p=c(!1),x=()=>{u.value=!u.value},M=()=>{p.value=!p.value},h=R(()=>{const t=o.newPassword;let e=0;return t.length>=8&&e++,t.match(/[a-z]/)&&e++,t.match(/[A-Z]/)&&e++,t.match(/[0-9]/)&&e++,t.match(/[^a-zA-Z0-9]/)&&e++,e}),S=()=>{const t=h.value;return t<2?"Weak":t<4?"Medium":"Strong"},B=()=>{const t=h.value;return t<2?"strength-weak":t<4?"strength-medium":"strength-strong"},$=()=>`${h.value/5*100}%`,A=()=>!o.newPassword||!o.confirmPassword?(alert(r("resetPassword.validation.fillAllFields")),!1):o.newPassword.length<8?(alert(r("resetPassword.validation.passwordLength")),!1):o.newPassword!==o.confirmPassword?(alert(r("resetPassword.validation.passwordsMatch")),!1):h.value<3?(alert(r("resetPassword.validation.passwordStrength")),!1):!0,j=async()=>{var t,e;if(A()){w.value=!0;try{const n=await b.resetPassword({email:v.value,reset_code:C.value,new_password:o.newPassword,new_password_confirm:o.confirmPassword});if(n.success)y.push({path:`/${m.locale}/confirmation`,query:{title:r("resetPassword.success.title"),message:r("resetPassword.success.message"),primaryActionText:r("resetPassword.success.actionButton"),primaryActionRoute:`/${m.locale}/login`}});else{let a=r("resetPassword.errors.updateFailed");(t=n.error)!=null&&t.reset_code?a=r("resetPassword.errors.invalidToken"):(e=n.error)!=null&&e.new_password?a=r("resetPassword.errors.weakPassword"):typeof n.error=="string"?a+=n.error:a+="Error desconocido",alert(a)}}catch(n){console.error("Password reset failed:",n),alert(r("resetPassword.errors.updateFailed")+(n.message||"Unknown error"))}finally{w.value=!1}}};return(t,e)=>{const n=E("router-link");return i(),l("div",J,[e[8]||(e[8]=s("div",{class:"background-container"},[s("div",{class:"background-overlay"})],-1)),f(Z,{position:"absolute",theme:"light"}),s("div",K,[s("div",O,[s("div",Q,[s("h2",X,d(t.$t("resetPassword.title")),1),s("p",Y,d(t.$t("resetPassword.subtitle")),1)]),s("form",{onSubmit:L(j,["prevent"]),class:"reset-password-form"},[s("div",ss,[s("div",es,[k(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>o.newPassword=a),type:u.value?"text":"password",placeholder:t.$t("resetPassword.newPasswordPlaceholder"),class:"form-input password-input",required:"",minlength:"8",autocomplete:"new-password"},null,8,ts),[[P,o.newPassword]]),s("button",{type:"button",onClick:x,class:"password-toggle"},[u.value?(i(),l("svg",os,[...e[2]||(e[2]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("path",{d:"M1 1l22 22",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(i(),l("svg",rs,[...e[3]||(e[3]=[s("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))])])]),s("div",ns,[s("div",as,[k(s("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>o.confirmPassword=a),type:p.value?"text":"password",placeholder:t.$t("resetPassword.confirmPasswordPlaceholder"),class:"form-input password-input",required:"",autocomplete:"new-password"},null,8,ls),[[P,o.confirmPassword]]),s("button",{type:"button",onClick:M,class:"password-toggle"},[p.value?(i(),l("svg",is,[...e[4]||(e[4]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("path",{d:"M1 1l22 22",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(i(),l("svg",ds,[...e[5]||(e[5]=[s("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))])])]),o.newPassword?(i(),l("div",cs,[s("div",ws,d(S()),1),s("div",us,[s("div",{class:D(["strength-fill",B()]),style:T({width:$()})},null,6)])])):F("",!0),s("button",{type:"submit",class:"submit-btn",disabled:w.value},[w.value?(i(),l("span",ms,[e[6]||(e[6]=s("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),_(" "+d(t.$t("resetPassword.updatingButton")),1)])):(i(),l("span",hs,d(t.$t("resetPassword.updateButton")),1))],8,ps)],32),s("div",gs,[f(n,{to:`/${U(m).locale}/reset-code?email=${v.value.value}`,class:"back-link-text"},{default:I(()=>[e[7]||(e[7]=s("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),_(" "+d(t.$t("resetPassword.backToCode")),1)]),_:1},8,["to"])])])])])}}},Cs=G(vs,[["__scopeId","data-v-1cb8dc5b"]]);export{Cs as default};
