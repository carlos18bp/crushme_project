import{u as B,r as P,l as F,E as A,o as T,c as i,b as n,d as e,p as D,z as G,H as V,Q as $,g as f,t as a,j as g,F as z,i as H,m as O,e as S,f as I}from"./index.T4J3j10_.js";import{P as q}from"./ProductCard.DxOTavgG.js";import{u as E}from"./orderStore.DGZz-fpq.js";import{u as Y}from"./profileStore.BJmYBBYm.js";import{_ as Q}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./cartStore.DdzdLVyM.js";import"./authStore.Dv_d0n5Q.js";import"./constants.DjCFsGER.js";import"./wishlistStore.DdGN0c1B.js";const U={class:"profile-history"},R={class:"px-4 md:px-6 py-6 md:py-8 lg:px-8 max-w-7xl mx-auto"},W={class:"filters-section mb-4 md:mb-6"},J={class:"filters-row flex flex-col sm:flex-row gap-3 md:gap-4 items-stretch sm:items-center"},K={class:"search-input relative flex-1 sm:max-w-xs"},X={class:"date-filter relative w-full sm:w-auto"},Z={key:0,class:"loading-state flex justify-center items-center py-12"},tt={key:1,class:"error-state text-center py-12"},et={class:"flex flex-col items-center justify-center"},st={class:"text-gray-500 font-comfortaa mb-6"},ot={key:2,class:"orders-list space-y-4 md:space-y-6"},at={class:"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6"},rt={class:"lg:col-span-2 space-y-3 md:space-y-4"},it={class:"order-id mb-3 md:mb-4 flex flex-wrap items-center gap-2 md:gap-3"},nt={class:"text-xs md:text-sm text-gray-600 font-comfortaa"},lt={key:0,class:"gift-badge px-2.5 md:px-3 py-0.5 md:py-1 bg-gradient-to-r from-pink-500 to-purple-500 text-white text-xs font-semibold rounded-full font-poppins flex items-center gap-1"},dt={class:"order-summary"},pt={class:"space-y-1 text-xs md:text-sm text-gray-600 font-comfortaa"},mt={class:"shipping-info"},ct={class:"space-y-1 text-xs md:text-sm text-gray-600 font-comfortaa"},ut={key:0,class:"gift-message mt-3 md:mt-4 p-3 md:p-4 bg-pink-50 rounded-lg md:rounded-xl border border-pink-200"},ft={class:"text-xs md:text-sm text-gray-700 font-comfortaa italic"},gt={class:"lg:col-span-1"},xt={key:0,class:"empty-state text-center py-8 md:py-12"},ht={class:"flex flex-col items-center justify-center"},yt={class:"text-sm md:text-base text-gray-500 font-comfortaa mb-4 md:mb-6"},vt={__name:"ProfileHistory",setup(bt){const h=O(),y=B(),l=E(),x=Y(),d=P(""),p=P(""),v=F(()=>{let o=[...l.orders];if(d.value){const t=d.value.toLowerCase();o=o.filter(s=>{var r,m;return((r=s.order_number)==null?void 0:r.toLowerCase().includes(t))||((m=s.items)==null?void 0:m.some(c=>{var u;return(u=c.product_name)==null?void 0:u.toLowerCase().includes(t)}))})}if(p.value){const t=new Date,s=new Date;switch(p.value){case"last-week":s.setDate(t.getDate()-7);break;case"last-month":s.setMonth(t.getMonth()-1);break;case"last-3-months":s.setMonth(t.getMonth()-3);break;case"last-year":s.setFullYear(t.getFullYear()-1);break}o=o.filter(r=>new Date(r.created_at)>=s)}return o.map(t=>{var w,_,k,M;const s=((w=t.items)==null?void 0:w[0])||{},r=t.is_gift===!0,m=Math.floor(parseFloat(s.unit_price||s.price||0)),c=Math.floor(parseFloat(t.total||0)),u=Math.floor(parseFloat(t.shipping_cost||0));return{id:t.id,orderNumber:t.order_number||t.id,quantity:s.quantity||1,price:m,shippingMethod:t.shipping_method||"Standard (5-7 business days)",shippingCost:u,total:c,shippingName:r?((_=t.gift_summary)==null?void 0:_.sender)||t.sender_username||"Gift Order":t.shipping_address||((k=t.billing_address)==null?void 0:k.first_name)||"",shippingAddress:r?((M=t.gift_summary)==null?void 0:M.privacy_note)||"Gift - Shipping details hidden for privacy":C(t.shipping_address,t.shipping_city,t.shipping_state,t.shipping_postal_code),shippingPhone:r?"Hidden for privacy":t.phone_number||"N/A",date:t.created_at,isGift:r,giftMessage:t.gift_message||null,isFavorited:N(s.woocommerce_product_id||s.product_id),product:{id:s.woocommerce_product_id||s.product_id,name:s.product_name||s.name||"Product",short_description:`<p>${s.product_description||s.description||""}</p><p class="price">$${m}</p>`,stock_status:s.stock_status||"instock",images:s.image_url?[{src:s.image_url}]:s.product_image?[{src:s.product_image}]:[]}}})}),L=F(()=>l.isLoading),C=(o,t,s,r)=>typeof o=="object"&&o!==null?[o.address_1||o.address,o.city,o.state,o.postcode||o.postal_code].filter(Boolean).join(", "):[o,t,s,r].filter(Boolean).join(", ")||"N/A",N=o=>o?x.favoriteProducts.some(t=>t.id===o):!1,j=o=>{h.push({name:`ProductDetails-${y.locale}`,params:{id:o}})},b=async()=>{const o=await l.fetchOrders();if(o.success){console.log("✅ Purchase history loaded:",l.orders.length,"orders");for(const t of l.orders)(!t.items||t.items.length===0)&&await l.fetchOrder(t.id)}else console.error("❌ Error loading purchase history:",o.error)};return A([d,p],()=>{}),T(async()=>{await b(),x.favoriteProducts.length===0&&await x.fetchFavoriteProducts()}),(o,t)=>(n(),i("div",U,[e("div",R,[t[16]||(t[16]=e("h1",{class:"text-2xl md:text-3xl font-medium text-gray-900 font-comfortaa mb-6 md:mb-8"}," Purchase History ",-1)),e("div",W,[t[6]||(t[6]=e("h2",{class:"text-base md:text-lg font-medium text-gray-900 font-comfortaa mb-3 md:mb-4"}," Filter by ",-1)),e("div",J,[e("div",K,[t[3]||(t[3]=e("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 md:h-5 md:w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),D(e("input",{type:"text",placeholder:"Search","onUpdate:modelValue":t[0]||(t[0]=s=>d.value=s),class:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-pink focus:border-transparent font-comfortaa"},null,512),[[G,d.value]])]),e("div",X,[D(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>p.value=s),class:"appearance-none w-full px-4 py-2 pr-10 text-sm md:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-pink focus:border-transparent font-comfortaa cursor-pointer bg-white"},[...t[4]||(t[4]=[$('<option value="" data-v-f3010ae1>Date</option><option value="last-week" data-v-f3010ae1>Last Week</option><option value="last-month" data-v-f3010ae1>Last Month</option><option value="last-3-months" data-v-f3010ae1>Last 3 Months</option><option value="last-year" data-v-f3010ae1>Last Year</option>',5)])],512),[[V,p.value]]),t[5]||(t[5]=e("span",{class:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none text-gray-400"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])])]),L.value?(n(),i("div",Z,[...t[7]||(t[7]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-pink"},null,-1)])])):f(l).error?(n(),i("div",tt,[e("div",et,[t[8]||(t[8]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-24 w-24 text-red-300 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t[9]||(t[9]=e("h3",{class:"text-xl font-medium text-gray-900 font-comfortaa mb-2"}," Error loading orders ",-1)),e("p",st,a(f(l).error),1),e("button",{onClick:b,class:"btn-retry px-6 py-3 rounded-full text-white font-semibold font-poppins transition-all duration-200 hover:opacity-90",style:{"background-color":"#DA9DFF"}}," Try Again ")])])):(n(),i("div",ot,[(n(!0),i(z,null,H(v.value,s=>(n(),i("div",{key:s.id,class:"order-card rounded-2xl md:rounded-3xl p-4 md:p-6 border border-gray-200",style:{"background-color":"rgba(255, 63, 213, 0.2)"}},[e("div",at,[e("div",rt,[e("div",it,[e("p",nt," Order ID #"+a(s.orderNumber),1),s.isGift?(n(),i("span",lt,[...t[10]||(t[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-2.5 w-2.5 md:h-3 md:w-3",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z"})],-1),S(" GIFT ",-1)])])):g("",!0)]),e("div",dt,[t[11]||(t[11]=e("h3",{class:"text-sm md:text-base font-semibold text-gray-900 font-comfortaa mb-2"}," Order Summary ",-1)),e("ul",pt,[e("li",null,"• Product: "+a(s.product.name),1),e("li",null,"• Quantity: "+a(s.quantity),1),e("li",null,"• Price: $"+a(s.price),1),e("li",null,"• Shipping: "+a(s.shippingMethod),1),e("li",null,"• Total: $"+a(s.total),1)])]),e("div",mt,[t[12]||(t[12]=e("h3",{class:"text-sm md:text-base font-semibold text-gray-900 font-comfortaa mb-2"}," Shipping information ",-1)),e("ul",ct,[e("li",null,"• Name: "+a(s.shippingName),1),e("li",null,"• Address: "+a(s.shippingAddress),1),e("li",null,"• Phone: "+a(s.shippingPhone),1)])]),s.isGift&&s.giftMessage?(n(),i("div",ut,[t[13]||(t[13]=e("h3",{class:"text-sm md:text-base font-semibold text-brand-pink font-comfortaa mb-2 flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 md:h-5 md:w-5 mr-1.5 md:mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z"})]),S(" Gift Message ")],-1)),e("p",ft,' "'+a(s.giftMessage)+'" ',1)])):g("",!0)]),e("div",gt,[I(q,{product:s.product,"is-in-favorites":s.isFavorited,onNavigateToProduct:j},null,8,["product","is-in-favorites"])])])]))),128)),v.value.length===0?(n(),i("div",xt,[e("div",ht,[t[14]||(t[14]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 md:h-20 md:w-20 lg:h-24 lg:w-24 text-gray-300 mb-3 md:mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})],-1)),t[15]||(t[15]=e("h3",{class:"text-lg md:text-xl font-medium text-gray-900 font-comfortaa mb-2"}," No orders found ",-1)),e("p",yt,a(d.value||p.value?"Try adjusting your filters":"You haven't made any purchases yet"),1),!d.value&&!p.value?(n(),i("button",{key:0,onClick:t[2]||(t[2]=s=>f(h).push({name:`Products-${f(y).locale}`})),class:"btn-shop px-5 md:px-6 py-2.5 md:py-3 rounded-full text-white font-semibold font-poppins text-sm md:text-base transition-all duration-200 hover:opacity-90",style:{"background-color":"#DA9DFF"}}," Start Shopping ")):g("",!0)])])):g("",!0)]))])]))}},Ct=Q(vt,[["__scopeId","data-v-f3010ae1"]]);export{Ct as default};
