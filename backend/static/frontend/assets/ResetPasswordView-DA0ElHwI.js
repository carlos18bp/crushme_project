import{p as z,u as q,r as w,B as N,q as R,i as L,c as i,o as l,a as s,d as k,t as c,s as F,h as T,v as P,y as _,l as D,n as E,b as y,w as I,e as U,f as H,k as W}from"../index.js";import{u as Z}from"./authStore-BFns-WxD.js";import{u as G}from"./useAlert-P81MXwWp.js";import{L as J}from"./LanguageSelector-vuDdTwQ1.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-DjCFsGER.js";const O={class:"reset-password-view"},Q={class:"reset-password-container"},X={class:"reset-password-card"},Y={class:"welcome-section"},ss={class:"welcome-title"},es={class:"welcome-subtitle"},ts={class:"input-group"},os={class:"password-input-container"},rs=["type","placeholder"],ns={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},as={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},is={class:"input-group"},ls={class:"password-input-container"},ds=["type","placeholder"],cs={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ws={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},us={key:0,class:"password-strength"},ps={class:"strength-label"},hs={class:"strength-bar"},ms=["disabled"],gs={key:0},fs={key:1,class:"loading-spinner"},vs={class:"back-link"},ks={__name:"ResetPasswordView",setup(Ps){const b=W(),f=N(),{t:r}=z(),g=q(),C=Z(),{showError:d}=G(),v=w(f.query.email||""),x=w(f.query.reset_code||""),o=R({newPassword:"",confirmPassword:""}),u=w(!1),p=w(!1),h=w(!1),M=()=>{p.value=!p.value},S=()=>{h.value=!h.value},m=L(()=>{const t=o.newPassword;let e=0;return t.length>=8&&e++,t.match(/[a-z]/)&&e++,t.match(/[A-Z]/)&&e++,t.match(/[0-9]/)&&e++,t.match(/[^a-zA-Z0-9]/)&&e++,e}),B=()=>{const t=m.value;return t<2?"Weak":t<4?"Medium":"Strong"},A=()=>{const t=m.value;return t<2?"strength-weak":t<4?"strength-medium":"strength-strong"},$=()=>`${m.value/5*100}%`,j=()=>!o.newPassword||!o.confirmPassword?(d(r("resetPassword.validation.fillAllFields")),!1):o.newPassword.length<8?(d(r("resetPassword.validation.passwordLength")),!1):o.newPassword!==o.confirmPassword?(d(r("resetPassword.validation.passwordsMatch")),!1):m.value<3?(d(r("resetPassword.validation.passwordStrength")),!1):!0,V=async()=>{var t,e;if(j()){u.value=!0;try{const n=await C.resetPassword({email:v.value,reset_code:x.value,new_password:o.newPassword,new_password_confirm:o.confirmPassword});if(n.success)b.push({path:`/${g.locale}/confirmation`,query:{title:r("resetPassword.success.title"),message:r("resetPassword.success.message"),primaryActionText:r("resetPassword.success.actionButton"),primaryActionRoute:`/${g.locale}/login`}});else{let a=r("resetPassword.errors.updateFailed");(t=n.error)!=null&&t.reset_code?a=r("resetPassword.errors.invalidToken"):(e=n.error)!=null&&e.new_password?a=r("resetPassword.errors.weakPassword"):typeof n.error=="string"?a+=n.error:a+="Error desconocido",d(a)}}catch(n){console.error("Password reset failed:",n),d(r("resetPassword.errors.updateFailed")+(n.message||"Unknown error"))}finally{u.value=!1}}};return(t,e)=>{const n=H("router-link");return l(),i("div",O,[e[8]||(e[8]=s("div",{class:"background-container"},[s("div",{class:"background-overlay"})],-1)),k(J,{position:"absolute",theme:"light"}),s("div",Q,[s("div",X,[s("div",Y,[s("h2",ss,c(t.$t("resetPassword.title")),1),s("p",es,c(t.$t("resetPassword.subtitle")),1)]),s("form",{onSubmit:F(V,["prevent"]),class:"reset-password-form"},[s("div",ts,[s("div",os,[P(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>o.newPassword=a),type:p.value?"text":"password",placeholder:t.$t("resetPassword.newPasswordPlaceholder"),class:"form-input password-input",required:"",minlength:"8",autocomplete:"new-password"},null,8,rs),[[_,o.newPassword]]),s("button",{type:"button",onClick:M,class:"password-toggle"},[p.value?(l(),i("svg",ns,[...e[2]||(e[2]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("path",{d:"M1 1l22 22",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(l(),i("svg",as,[...e[3]||(e[3]=[s("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))])])]),s("div",is,[s("div",ls,[P(s("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>o.confirmPassword=a),type:h.value?"text":"password",placeholder:t.$t("resetPassword.confirmPasswordPlaceholder"),class:"form-input password-input",required:"",autocomplete:"new-password"},null,8,ds),[[_,o.confirmPassword]]),s("button",{type:"button",onClick:S,class:"password-toggle"},[h.value?(l(),i("svg",cs,[...e[4]||(e[4]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("path",{d:"M1 1l22 22",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(l(),i("svg",ws,[...e[5]||(e[5]=[s("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))])])]),o.newPassword?(l(),i("div",us,[s("div",ps,c(B()),1),s("div",hs,[s("div",{class:E(["strength-fill",A()]),style:D({width:$()})},null,6)])])):T("",!0),s("button",{type:"submit",class:"submit-btn",disabled:u.value},[u.value?(l(),i("span",fs,[e[6]||(e[6]=s("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" "+c(t.$t("resetPassword.updatingButton")),1)])):(l(),i("span",gs,c(t.$t("resetPassword.updateButton")),1))],8,ms)],32),s("div",vs,[k(n,{to:`/${U(g).locale}/reset-code?email=${v.value.value}`,class:"back-link-text"},{default:I(()=>[e[7]||(e[7]=s("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),y(" "+c(t.$t("resetPassword.backToCode")),1)]),_:1},8,["to"])])])])])}}},Ss=K(ks,[["__scopeId","data-v-f9322668"]]);export{Ss as default};
