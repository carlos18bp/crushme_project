import{u as z,r as g,i as G,D as V,j as $,k as T,c as n,o as r,a as t,n as L,O as w,h as d,v as S,x as B,E as F,F as U,g as P,t as l,e as C,K as E,b,d as H}from"../index.js";import{u as O}from"./orderStore-CzQm_mOM.js";import{u as j}from"./authStore-tY-7-Xic.js";import{P as q}from"./ProductCard-C1-pDTjR.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-DjCFsGER.js";import"./cartStore-VCuiRpOe.js";import"./profileStore-DZizYbaJ.js";import"./wishlistStore-2Sa37WF2.js";const K={class:"my-gifts"},Y={class:"px-4 md:px-6 py-6 md:py-8 lg:px-8 max-w-7xl mx-auto"},Q={class:"tabs-container mb-6 md:mb-8"},W={class:"flex gap-1 md:gap-2 border-b border-brand-pink-light overflow-x-auto"},X={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-brand-pink"},J={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-brand-pink"},Z={class:"filters-section mb-4 md:mb-6"},ee={class:"filters-row flex flex-col sm:flex-row gap-3 md:gap-4 items-stretch sm:items-center"},te={class:"search-input relative flex-1 sm:max-w-xs"},se={class:"date-filter relative w-full sm:w-auto"},oe={key:0,class:"loading-state flex justify-center items-center py-12"},ae={key:1,class:"gifts-list space-y-4 md:space-y-6"},ne={class:"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6"},re={class:"lg:col-span-2 space-y-3 md:space-y-4"},le={class:"order-id mb-3 md:mb-4 flex flex-wrap items-center gap-2 md:gap-3"},ie={class:"text-xs md:text-sm text-brand-blue-medium font-comfortaa"},de={class:"gift-info"},ue={class:"space-y-1 text-xs md:text-sm text-brand-blue-medium font-comfortaa"},pe={key:0},ce={class:"font-semibold text-brand-pink"},me={key:1},be={class:"font-semibold text-brand-pink"},ge={class:"capitalize"},ve={key:0,class:"gift-message p-3 md:p-4 bg-brand-pink-lighter rounded-lg md:rounded-xl border border-brand-pink-light"},fe={class:"text-xs md:text-sm text-brand-dark font-comfortaa italic"},he={key:1,class:"shipping-info"},xe={class:"space-y-1 text-xs md:text-sm text-brand-blue-medium font-comfortaa"},we={key:2,class:"privacy-note p-3 bg-brand-pink-lighter rounded-lg border border-brand-purple-light"},ye={class:"lg:col-span-1"},ke={key:0,class:"empty-state text-center py-12"},_e={class:"flex flex-col items-center justify-center"},Me={class:"text-xl font-medium text-brand-dark font-comfortaa mb-2"},Ge={class:"text-brand-blue-medium font-comfortaa mb-6"},Le={__name:"MyGifts",setup(Se){const u=T(),c=z();O();const i=j(),a=g("received"),v=g(""),f=g(""),m=g([]),h=g(!1),D=G(()=>{let o=[...m.value];if(o=o.filter(e=>a.value==="received"?e.receiver_username===i.username:e.sender_username===i.username),v.value){const e=v.value.toLowerCase();o=o.filter(s=>{var p,x,_,M;return((p=s.orderNumber)==null?void 0:p.toLowerCase().includes(e))||((_=(x=s.product)==null?void 0:x.name)==null?void 0:_.toLowerCase().includes(e))||((M=s.message)==null?void 0:M.toLowerCase().includes(e))})}if(f.value){const e=new Date,s=new Date;switch(f.value){case"last-week":s.setDate(e.getDate()-7);break;case"last-month":s.setMonth(e.getMonth()-1);break;case"last-3-months":s.setMonth(e.getMonth()-3);break;case"last-year":s.setFullYear(e.getFullYear()-1);break}o=o.filter(p=>new Date(p.createdAt)>=s)}return o}),y=G(()=>D.value.map(o=>{var p;const e=((p=o.items)==null?void 0:p[0])||{},s=o.is_gift===!0;return{id:o.id,orderNumber:o.order_number||o.id,quantity:e.quantity||1,value:Math.floor(parseFloat(e.unit_price||e.price||0)),status:o.status,sender:o.sender_username||"Anonymous",receiver:o.receiver_username||"Anonymous",message:o.gift_message||null,shippingAddress:s?"Dirección de envío privada (regalo)":o.shipping_address||"N/A",shippingCity:o.shipping_city||"N/A",createdAt:o.created_at,product:{id:e.woocommerce_product_id||e.product_id,name:e.product_name||e.name||"Product",short_description:`<p>${e.product_description||e.description||""}</p><p class="price">$${Math.floor(parseFloat(e.unit_price||e.price||0))}</p>`,stock_status:e.stock_status||"instock",images:e.image_url?[{src:e.image_url}]:e.product_image?[{src:e.product_image}]:[]}}})),I=o=>{u.push({name:`ProductDetails-${c.locale}`,params:{id:o}})},A=o=>new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),k=async()=>{var o,e;h.value=!0;try{if(console.log("🎁 [MyGifts] Loading gifts for tab:",a.value),console.log("🎁 [MyGifts] User authenticated:",i.isLoggedIn),console.log("🎁 [MyGifts] Access token exists:",!!localStorage.getItem("access_token")),!i.isLoggedIn){console.log("🎁 [MyGifts] User not authenticated, redirecting to login"),u.push({name:`Login-${c.locale}`});return}const s=await E(`orders/gifts/?type=${a.value}`);s.data?(m.value=Array.isArray(s.data)?s.data:s.data.orders||[],console.log("🎁 [MyGifts] Gifts loaded:",m.value.length,"gifts"),console.log("🎁 [MyGifts] Gifts data sample:",m.value[0]||"No gifts")):(console.error("🎁 [MyGifts] No data in response"),m.value=[])}catch(s){if(console.error("🎁 [MyGifts] Error loading gifts:",s),console.error("🎁 [MyGifts] Error details:",((o=s.response)==null?void 0:o.data)||s.message),((e=s.response)==null?void 0:e.status)===401){console.log("🎁 [MyGifts] Unauthorized - token may be invalid or expired"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),u.push({name:`Login-${c.locale}`});return}m.value=[]}finally{h.value=!1}};V(a,()=>{console.log("🎁 [MyGifts] Tab changed to:",a.value),i.isLoggedIn?k():(console.log("🎁 [MyGifts] User not authenticated, redirecting to login"),u.push({name:`Login-${c.locale}`}))});const N=()=>{console.log("🔍 [MyGifts] Authentication Debug Info:"),console.log("  - isLoggedIn:",i.isLoggedIn),console.log("  - hasToken:",!!localStorage.getItem("access_token")),console.log("  - hasRefreshToken:",!!localStorage.getItem("refresh_token")),console.log("  - user:",i.user),console.log("  - token value:",localStorage.getItem("access_token")?"[TOKEN EXISTS]":"[NO TOKEN]"),console.log("  - Current route:",u.currentRoute.value.name),console.log("  - Current tab:",a.value)};return $(async()=>{i.initializeAuth(),console.log("🎁 [MyGifts] Component mounted"),N(),i.isLoggedIn?(console.log("🎁 [MyGifts] User authenticated, loading gifts..."),await k()):(console.log("🎁 [MyGifts] User not authenticated, redirecting to login"),u.push({name:`Login-${c.locale}`}))}),(o,e)=>(r(),n("div",K,[t("div",Y,[e[21]||(e[21]=t("h1",{class:"text-2xl md:text-3xl font-medium text-brand-dark font-comfortaa mb-6 md:mb-8"}," My Gifts ",-1)),t("div",Q,[t("div",W,[t("button",{onClick:e[0]||(e[0]=s=>a.value="received"),class:L(["tab-btn px-4 md:px-6 py-2.5 md:py-3 font-semibold font-poppins text-xs md:text-sm transition-all duration-200 relative whitespace-nowrap",a.value==="received"?"text-brand-pink":"text-brand-blue-medium hover:text-brand-pink-dark"])},[e[5]||(e[5]=w('<span class="flex items-center gap-1.5 md:gap-2" data-v-a1bd95bb><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-5 md:w-5" viewBox="0 0 20 20" fill="currentColor" data-v-a1bd95bb><path d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" data-v-a1bd95bb></path></svg><span class="hidden sm:inline" data-v-a1bd95bb>Gifts Received</span><span class="sm:hidden" data-v-a1bd95bb>Received</span></span>',1)),a.value==="received"?(r(),n("span",X)):d("",!0)],2),t("button",{onClick:e[1]||(e[1]=s=>a.value="sent"),class:L(["tab-btn px-4 md:px-6 py-2.5 md:py-3 font-semibold font-poppins text-xs md:text-sm transition-all duration-200 relative whitespace-nowrap",a.value==="sent"?"text-brand-pink":"text-brand-blue-medium hover:text-brand-pink-dark"])},[e[6]||(e[6]=w('<span class="flex items-center gap-1.5 md:gap-2" data-v-a1bd95bb><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-5 md:w-5" viewBox="0 0 20 20" fill="currentColor" data-v-a1bd95bb><path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z" data-v-a1bd95bb></path></svg><span class="hidden sm:inline" data-v-a1bd95bb>Gifts Sent</span><span class="sm:hidden" data-v-a1bd95bb>Sent</span></span>',1)),a.value==="sent"?(r(),n("span",J)):d("",!0)],2)])]),t("div",Z,[e[10]||(e[10]=t("h2",{class:"text-base md:text-lg font-medium text-brand-dark font-comfortaa mb-3 md:mb-4"}," Filter by ",-1)),t("div",ee,[t("div",te,[e[7]||(e[7]=t("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-brand-pink-medium"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 md:h-5 md:w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),S(t("input",{type:"text",placeholder:"Search","onUpdate:modelValue":e[2]||(e[2]=s=>v.value=s),class:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-brand-pink-light rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-pink focus:border-transparent font-comfortaa text-brand-dark"},null,512),[[B,v.value]])]),t("div",se,[S(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>f.value=s),class:"appearance-none w-full px-4 py-2 pr-10 text-sm md:text-base border border-brand-pink-light rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-pink focus:border-transparent font-comfortaa cursor-pointer bg-white text-brand-dark"},[...e[8]||(e[8]=[w('<option value="" data-v-a1bd95bb>Date</option><option value="last-week" data-v-a1bd95bb>Last Week</option><option value="last-month" data-v-a1bd95bb>Last Month</option><option value="last-3-months" data-v-a1bd95bb>Last 3 Months</option><option value="last-year" data-v-a1bd95bb>Last Year</option>',5)])],512),[[F,f.value]]),e[9]||(e[9]=t("span",{class:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none text-brand-pink-medium"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])])]),h.value?(r(),n("div",oe,[...e[11]||(e[11]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-pink"},null,-1)])])):(r(),n("div",ae,[(r(!0),n(U,null,P(y.value,s=>(r(),n("div",{key:s.id,class:"gift-card rounded-2xl md:rounded-3xl p-4 md:p-6 border border-brand-pink-light bg-brand-pink-lighter"},[t("div",ne,[t("div",re,[t("div",le,[t("p",ie," Order ID #"+l(s.orderNumber),1),e[12]||(e[12]=t("span",{class:"gift-badge px-2.5 md:px-3 py-0.5 md:py-1 bg-gradient-to-r from-brand-pink to-brand-purple-light text-white text-xs font-semibold rounded-full font-poppins flex items-center gap-1"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-2.5 w-2.5 md:h-3 md:w-3",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z"})]),b(" GIFT ")],-1))]),t("div",de,[e[16]||(e[16]=t("h3",{class:"text-sm md:text-base font-semibold text-brand-dark font-comfortaa mb-2"}," Gift Information ",-1)),t("ul",ue,[a.value==="received"?(r(),n("li",pe,[e[13]||(e[13]=b("• From: ",-1)),t("span",ce,l(s.sender),1)])):d("",!0),a.value==="sent"?(r(),n("li",me,[e[14]||(e[14]=b("• To: ",-1)),t("span",be,l(s.receiver),1)])):d("",!0),t("li",null,"• Product: "+l(s.product.name),1),t("li",null,"• Quantity: "+l(s.quantity),1),t("li",null,"• Value: $"+l(s.value),1),t("li",null,[e[15]||(e[15]=b("• Status: ",-1)),t("span",ge,l(s.status),1)])])]),s.message?(r(),n("div",ve,[e[17]||(e[17]=t("h3",{class:"text-sm md:text-base font-semibold text-brand-pink font-comfortaa mb-2 flex items-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 md:h-5 md:w-5 mr-1.5 md:mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M18 13V5a2 2 0 00-2-2H4a2 2 0 00-2 2v8a2 2 0 002 2h3l3 3 3-3h3a2 2 0 002-2zM5 7a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm1 3a1 1 0 100 2h3a1 1 0 100-2H6z","clip-rule":"evenodd"})]),b(" Message ")],-1)),t("p",fe,' "'+l(s.message)+'" ',1)])):d("",!0),a.value==="sent"?(r(),n("div",he,[e[18]||(e[18]=t("h3",{class:"text-sm md:text-base font-semibold text-brand-dark font-comfortaa mb-2"}," Shipping information ",-1)),t("ul",xe,[t("li",null,"• Address: "+l(s.shippingAddress),1),t("li",null,"• City: "+l(s.shippingCity),1),t("li",null,"• Date: "+l(A(s.createdAt)),1)])])):d("",!0),a.value==="received"?(r(),n("div",we,[...e[19]||(e[19]=[t("p",{class:"text-xs text-brand-purple-light font-comfortaa flex items-center gap-2"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"})]),b(" Shipping details hidden for privacy ")],-1)])])):d("",!0)]),t("div",ye,[H(q,{product:s.product,"is-in-favorites":!1,onNavigateToProduct:I},null,8,["product"])])])]))),128)),y.value.length===0&&!h.value?(r(),n("div",ke,[t("div",_e,[e[20]||(e[20]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-24 w-24 text-brand-pink-light mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"})],-1)),t("h3",Me," No gifts "+l(a.value==="received"?"received":"sent")+" yet ",1),t("p",Ge,l(a.value==="received"?"When someone sends you a gift, it will appear here":"Send your first gift to someone special"),1),a.value==="sent"?(r(),n("button",{key:0,onClick:e[4]||(e[4]=s=>C(u).push({name:`Products-${C(c).locale}`})),class:"btn-shop px-6 py-3 rounded-full text-white font-semibold font-poppins transition-all duration-200 hover:opacity-90 bg-brand-purple-light"}," Send a Gift ")):d("",!0)])])):d("",!0)]))])]))}},Be=R(Le,[["__scopeId","data-v-a1bd95bb"]]);export{Be as default};
