import{u as S,r as w,j as E,A as R,k as T,c,o as u,a as s,h as v,t as y}from"../index.js";import{u as b}from"./cartStore-VCuiRpOe.js";import{u as k}from"./wishlistStore-BgqpnbBu.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-DjCFsGER.js";const C={class:"min-h-screen bg-brand-pink-lighter flex items-center justify-center p-4"},W={class:"max-w-md w-full bg-white rounded-2xl shadow-lg p-8 text-center"},D={key:0},H={key:1},L={class:"text-gray-600 mb-4"},B={__name:"WishlistCheckoutRedirect",setup(N){const d=R(),m=T(),g=k(),n=b(),p=S(),h=w(!0),l=w(null);E(async()=>{try{const r=d.params.username,e=d.params.wishlistId;if(console.log("🎁 [WISHLIST REDIRECT] Loading wishlist:",{username:r,wishlistId:e}),!r||!e)throw new Error("Invalid wishlist link");const a=await g.fetchPublicWishlistByUsername(r,e);if(!a.success||!a.data)throw new Error(a.error||"Wishlist not found");const o=a.data;if(console.log("✅ [WISHLIST REDIRECT] Wishlist loaded:",o),!o.items||o.items.length===0)throw new Error("This wishlist is empty");n.clearCart();for(const t of o.items)if(t.is_available){const i=parseFloat(t.product_price);(isNaN(i)||i===0)&&console.error("❌ [WISHLIST REDIRECT] Invalid price for item:",t.product_name,"Price:",t.product_price);const I={name:t.product_name,price:i,image:t.product_image,variation_id:t.woocommerce_variation_id||null,attributes:t.attributes||null,stock_status:"instock"};console.log("➕ [WISHLIST REDIRECT] Adding to cart:",{productId:t.woocommerce_product_id,quantity:1,productData:I,priceType:typeof i,priceValue:i,currency:t.currency||o.currency});const f=n.addToCart(t.woocommerce_product_id,1,I);console.log("✅ [WISHLIST REDIRECT] Add to cart result:",f)}else console.warn("⚠️ [WISHLIST REDIRECT] Skipping unavailable item:",t.product_name);console.log("🛒 [WISHLIST REDIRECT] Cart updated with",n.items.length,"items"),console.log("💰 [WISHLIST REDIRECT] Total value:",o.total_value,o.currency),await new Promise(t=>setTimeout(t,500)),console.log("🔄 [WISHLIST REDIRECT] Redirecting to checkout..."),m.push({name:`Checkout-${p.locale}`,query:{giftMode:"true",username:o.user_username,wishlistId:o.id,wishlistName:o.name}})}catch(r){console.error("❌ [WISHLIST REDIRECT] Error:",r),l.value=r.message||"Failed to load wishlist",h.value=!1}});const _=()=>{m.push({name:`Home-${p.locale}`})};return(r,e)=>(u(),c("div",C,[s("div",W,[h.value?(u(),c("div",D,[...e[0]||(e[0]=[s("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-brand-pink mx-auto mb-4"},null,-1),s("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"Loading wishlist...",-1),s("p",{class:"text-gray-600"},"Preparing your gift checkout",-1)])])):l.value?(u(),c("div",H,[e[1]||(e[1]=s("div",{class:"text-red-500 mb-4"},[s("svg",{class:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e[2]||(e[2]=s("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"Oops! Something went wrong",-1)),s("p",L,y(l.value),1),s("button",{onClick:_,class:"px-6 py-2 bg-brand-pink text-white rounded-full hover:opacity-90 transition-all"}," Go to Home ")])):v("",!0)])]))}},q=x(B,[["__scopeId","data-v-5dd23457"]]);export{q as default};
