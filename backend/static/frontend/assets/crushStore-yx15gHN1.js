import{I as T,r as i,l as f,M as p}from"../index.js";const k=T("crush",()=>{const v=i(null),d=i(null),m=i([]),g=i([]),h=i([]),r=i({total:0,offset:0,limit:50,count:0}),u=i(!1),w=i(!1),n=i(null),R=f(()=>!!v.value),$=f(()=>!!d.value),M=f(()=>m.value.length>0),b=f(()=>g.value.length>0),F=f(()=>h.value.length>0),x=f(()=>Math.floor(r.value.offset/r.value.limit)+1),E=f(()=>Math.ceil(r.value.total/r.value.limit)),S=f(()=>r.value.offset+r.value.count<r.value.total),P=f(()=>r.value.offset>0);async function A(a){var s,e;u.value=!0,n.value=null,v.value=null;try{console.log(`üéØ Fetching public profile for: @${a}`);const t=await p(`auth/public/@${a}/`);if(t.data.success)return v.value=t.data.data,console.log("‚úÖ Profile loaded:",v.value),v.value;throw new Error(t.data.error||"Failed to fetch profile")}catch(t){const o=((e=(s=t.response)==null?void 0:s.data)==null?void 0:e.error)||t.message||"Error fetching profile";throw n.value=o,console.error("‚ùå Error fetching public profile:",o),t}finally{u.value=!1}}async function L(){var a,s;u.value=!0,n.value=null,d.value=null;try{console.log("üé≤ Fetching random Crush...");const e=await p("auth/crush/random/");if(e.data.success)return d.value=e.data.data,console.log("‚úÖ Random Crush loaded:",d.value),d.value;throw new Error(e.data.error||"Failed to fetch random Crush")}catch(e){const t=((s=(a=e.response)==null?void 0:a.data)==null?void 0:s.error)||e.message||"Error fetching random Crush";throw n.value=t,console.error("‚ùå Error fetching random Crush:",t),e}finally{u.value=!1}}async function N(){var a,s;u.value=!0,n.value=null,m.value=[];try{console.log("üé† Fetching 7 random Crushes for carousel...");const e=await p("auth/crush/random-7/");if(e.data.success)return m.value=e.data.results,console.log(`‚úÖ ${e.data.count} Crushes loaded for carousel`),m.value;throw new Error(e.data.error||"Failed to fetch random Crushes")}catch(e){const t=((s=(a=e.response)==null?void 0:a.data)==null?void 0:s.error)||e.message||"Error fetching random Crushes";throw n.value=t,console.error("‚ùå Error fetching random 7 Crushes:",t),e}finally{u.value=!1}}async function C({limit:a=50,offset:s=0}={}){var e,t;u.value=!0,n.value=null;try{console.log(`üìã Fetching Crush list (limit: ${a}, offset: ${s})...`);const o=new URLSearchParams;o.append("limit",a),o.append("offset",s);const c=`auth/crush/list/?${o.toString()}`,l=await p(c);if(l.data.success)return g.value=l.data.results,r.value={total:l.data.total,offset:l.data.offset,limit:l.data.limit,count:l.data.count},console.log(`‚úÖ ${l.data.count} Crushes loaded (${l.data.total} total)`),g.value;throw new Error(l.data.error||"Failed to fetch Crush list")}catch(o){const c=((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.error)||o.message||"Error fetching Crush list";throw n.value=c,console.error("‚ùå Error fetching Crush list:",c),o}finally{u.value=!1}}async function H(a,s=5){var e,t;if(!a||!a.trim())return h.value=[],[];w.value=!0,n.value=null;try{console.log(`üîç [SEARCH] Buscando usuarios: "${a}" (limit: ${s})...`);const o=new URLSearchParams;o.append("q",a.trim()),o.append("limit",s);const c=`users/search/?${o.toString()}`,l=await p(c);if(l.data.success)return h.value=l.data.results,console.log(`‚úÖ [SEARCH] ${l.data.count} usuarios encontrados`),console.log("üì¶ [SEARCH] Resultados con shipping:",l.data.results),h.value;throw new Error(l.data.error||"Search failed")}catch(o){const c=((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.error)||o.message||"Error searching users";throw n.value=c,console.error("‚ùå [SEARCH] Error buscando usuarios:",c),h.value=[],o}finally{w.value=!1}}async function O(){if(!S.value)return console.warn("‚ö†Ô∏è No next page available"),g.value;const a=r.value.offset+r.value.limit;return await C({limit:r.value.limit,offset:a})}async function U(){if(!P.value)return console.warn("‚ö†Ô∏è No previous page available"),g.value;const a=Math.max(0,r.value.offset-r.value.limit);return await C({limit:r.value.limit,offset:a})}async function _(a){const e=(Math.max(1,Math.min(a,E.value))-1)*r.value.limit;return await C({limit:r.value.limit,offset:e})}function B(){h.value=[],n.value=null,console.log("üßπ Search results cleared")}function D(){v.value=null,d.value=null,m.value=[],g.value=[],h.value=[],r.value={total:0,offset:0,limit:50,count:0},n.value=null,console.log("üßπ All Crush data cleared")}function y(){return"/default-avatar.png"}function I(a){return(a==null?void 0:a.profile_picture_url)||y()}return{crushProfile:v,randomCrush:d,randomSevenCrushes:m,crushList:g,searchResults:h,pagination:r,isLoading:u,isSearching:w,error:n,hasCrushProfile:R,hasRandomCrush:$,hasRandomSevenCrushes:M,hasCrushList:b,hasSearchResults:F,currentPage:x,totalPages:E,hasNextPage:S,hasPrevPage:P,fetchPublicProfile:A,fetchRandomCrush:L,fetchRandomSevenCrushes:N,fetchCrushList:C,searchUsers:H,nextPage:O,prevPage:U,goToPage:_,clearSearch:B,clearAll:D,getDefaultAvatar:y,getProfilePicture:I}});export{k as u};
